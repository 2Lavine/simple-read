<h1>2023-09-03</h1><h1>æˆè¯­</h1>
<p>å¹¶è¡Œä¸æ‚–ï¼šä¾§é‡äºçœ‹ä¼¼å†²çªçš„äº‹ç‰©å¹¶ä¸å†²çªï¼Œå¯ä»¥å…±å­˜ã€‚ä¸å¼ºè°ƒæ—¶é—´ã€‚
å¹¶é©¾é½é©±ï¼šä¸€èµ·å‘å±•ã€‚ç›¸å¯¹äºé½å¤´å¹¶è¿›ï¼Œå½¢å®¹çš„è¯æ›´å¤§ä¸€äº›
é½å¤´/é©±å¹¶è¿›ï¼šå¼ºè°ƒåŒæ—¶å‘ç”Ÿï¼Œä¸å¼ºè°ƒç¨‹åº¦ã€‚æ›´å…·ä½“ä¸€äº›</p>

<h1>2023-09-04</h1><p>è·³å‡ºæ¡†æ¶,è§£å†³æ ¹æœ¬æ€§é—®é¢˜.çˆ±å› æ–¯å¦:: é—®é¢˜ä¸èƒ½åœ¨äº§ç”Ÿå®ƒä»¬çš„æ„è¯†å±‚æ¬¡ä¸Šå¾—åˆ°è§£å†³</p>

<h1>Nest.js çš„å¾®æœåŠ¡ï¼Œå†™èµ·æ¥ä¹Ÿå¤ªç®€å•äº†å§ï¼</h1><blockquote>
<p>æœ¬æ–‡ç”± <a href="http://ksria.com/simpread/">ç®€æ‚¦ SimpRead</a> è½¬ç ï¼Œ åŸæ–‡åœ°å€ <a href="https://juejin.cn/post/7207637337571901495?searchId=20230901115242BA94AF700DEF9495FDC5">juejin.cn</a></p>
</blockquote>
<p>å¤§å®¶éƒ½å†™è¿‡ http æœåŠ¡ï¼Œæ¥å— http è¯·æ±‚ã€åšä¸€äº›å¤„ç†ã€è¿”å› http å“åº”ã€‚
è¿™æ ·å®Œæˆ web æœåŠ¡å™¨çš„åŠŸèƒ½æ²¡é—®é¢˜ï¼Œ
ä½†éšç€åŠŸèƒ½çš„è¶Šæ¥è¶Šå¤šï¼Œæ¯”å¦‚ç°åœ¨æœ‰ä¸€ç™¾å¤šä¸ªæ¨¡å—äº†ï¼Œæ”¾åœ¨ä¸€ä¸ªæœåŠ¡é‡Œå¯¼è‡´ç®¡ç†ä¸æ–¹ä¾¿ã€‚
ç°åœ¨éƒ½æ˜¯æ‹†æˆå¾®æœåŠ¡çš„æ–¹å¼ï¼Œhttp æœåŠ¡è´Ÿè´£å¤„ç† http è¯·æ±‚ï¼Œå¾®æœåŠ¡å®Œæˆä¸åŒæ¨¡å—çš„ä¸šåŠ¡é€»è¾‘å¤„ç†ã€‚</p>
<h2>å¾®æœåŠ¡å’Œ http æœåŠ¡é€šä¿¡</h2>
<p><img src="file://Mac/Home/myGitHubMac/simple-read/_resources/Pasted image 20230903193834.png" /></p>
<p>æ‹†åˆ†å¾®æœåŠ¡æ˜¯å¾ˆè‡ªç„¶çš„äº‹æƒ…ï¼Œä½†æœ‰ä¸ªé—®é¢˜ï¼Œå¾®æœåŠ¡å’Œ http æœåŠ¡ä¹‹é—´æ€ä¹ˆé€šä¿¡å‘¢ï¼Ÿ
HTTP æ˜¯æ–‡æœ¬åè®®ï¼Œä¼ è¾“æ•ˆç‡å¤ªä½äº†ã€‚æ‰€ä»¥ä¸€èˆ¬éƒ½ç›´æ¥ç”¨ TCP é€šä¿¡ã€‚</p>
<p>Nest å¾®æœåŠ¡</p>
<p>ç”¨ nest è·‘ä¸ªå¾®æœåŠ¡çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ul>
<li>ç”¨ nest new åˆ›å»ºä¸€ä¸ª main æœåŠ¡ï¼Œä¸€ä¸ªå¾®æœåŠ¡</li>
<li>éƒ½è¦å®‰è£… @nestjs/microservices åŒ…ï¼Œå› ä¸ºç”¨åˆ°å…¶ä¸­çš„ api</li>
<li>å¾®æœåŠ¡é‡Œç”¨ createMicroservice å¯åŠ¨æœåŠ¡ï¼Œé€‰æ‹©ä¼ è¾“æ–¹å¼ä¸º TCPï¼ŒæŒ‡å®šç«¯å£</li>
<li>å¾®æœåŠ¡é‡Œåœ¨ Controller ä½¿ç”¨ MessagePattern æˆ–è€… EventPattern æ³¨å†Œå¤„ç†æ¶ˆæ¯çš„ handler</li>
<li>main æœåŠ¡ä½¿ç”¨ ClientsModule.register æ¥æ³¨å†Œå¾®æœåŠ¡</li>
<li>main æœåŠ¡é‡Œæ³¨å…¥ ClientProxy å¯¹è±¡ï¼Œè°ƒç”¨å®ƒçš„ send æ–¹æ³•ç»™å¾®æœåŠ¡å‘æ¶ˆæ¯</li>
</ul>
<h3>createMicroserviceå¯åŠ¨å¾®æœåŠ¡</h3>
<p><img src="file://Mac/Home/myGitHubMac/simple-read/_resources/ab549d4f236b1cec1298425a3b057379_MD5.webp" />
å¯åŠ¨çš„æ—¶å€™æŒ‡å®šç”¨ TCP æ¥ä¼ è¾“æ¶ˆæ¯ï¼Œç„¶åæŒ‡å®š TCP å¯åŠ¨çš„ç«¯å£ä¸º 8888ã€‚</p>
<h3>main æœåŠ¡å™¨calc å¾®æœåŠ¡</h3>
<p>åœ¨ app.module.ts é‡Œæ³¨å†Œ calc é‚£ä¸ªå¾®æœåŠ¡ï¼š
<img src="file://Mac/Home/myGitHubMac/simple-read/_resources/ea45292db6fbc7633595acf86ed721a3_MD5.webp" /></p>
<p>è°ƒç”¨ ClientModule.register æŒ‡å®šåå­—ã€ä¼ è¾“æ–¹å¼ä¸º TCPã€ç«¯å£ä¸º 8888ã€‚</p>
<h2>ClientProxy ç»™å¾®æœåŠ¡å‘è¯·æ±‚</h2>
<p>åœ¨ Controller é‡Œæ³¨å…¥è¿™ä¸ªå¾®æœåŠ¡çš„ clientProxyï¼Œä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯ä»£ç†ã€‚</p>
<p><img src="file://Mac/Home/myGitHubMac/simple-read/_resources/b0a584439a7a189d9f90d1ca92916576_MD5.webp" /></p>
<p>è¿™æ ·å°±å¯ä»¥æ¥æ”¶åˆ° http è¯·æ±‚çš„æ—¶å€™è°ƒç”¨å¾®æœåŠ¡æ¥å¤„ç†äº†ã€‚
æ¯”å¦‚ä¸Šé¢æˆ‘ä»¬åœ¨æ”¶åˆ°è¯·æ±‚çš„æ—¶å€™ï¼Œè°ƒç”¨ä»£ç†å¯¹è±¡çš„ send æ–¹æ³•å‘äº†ä¸€ä¸ª TCP æ¶ˆæ¯ç»™å¾®æœåŠ¡ã€‚
è¿™ä¹Ÿæ˜¯ä¸ºå•¥å«åš ClientProxy äº†ï¼Œä¸ç”¨ä½ è‡ªå·±å‘ TCP æ¶ˆæ¯ï¼Œä½ åªè¦è°ƒç”¨ send æ–¹æ³•å³å¯ã€‚</p>

<h1>day03_designModel</h1><p><img src="file://Mac/Home/myGitHubMac/simple-read/_resources/Pasted image 20230830092512.png" /></p>
<h2>OOAD Workflows</h2>
<p>requirements-&gt;analyse Model-&gt;Design Model</p>
<p>-&gt;requirements=user case diagram,use case description
-&gt;begin analyse Model= sequence(collaboration) and class diagram
-&gt;begin design Model=</p>
<p>user case diagram is same as user story,sometime u can only choose one.
non-functional requirement: security some perfromance... it actually affected by the adesin model
boundry objs are not interface</p>
<h2>modele desgin</h2>
<p>Platform specific
not only logic design
<img src="file://Mac/Home/myGitHubMac/simple-read/_resources/Pasted image 20230830140940.png" /></p>
<h3>Transition Strategies</h3>
<p>From Anaylse Model to Design Model</p>
<ol>
<li>Programming Language</li>
<li>Distributed System</li>
<li>Persistence</li>
</ol>
<h3>3. Persistence Obj</h3>
<p>Entity objects are potential candidates of persistent objects(saved in db)</p>
<ul>
<li>sometimes entity maybe just be a passing obj between controller objs</li>
</ul>
<p>Mapping from Object Model to Relational Model</p>
<ul>
<li>Adjusting objects to access database</li>
<li>normally ER diagram,Data Dictionary</li>
</ul>
<hr>
<p>Use case controller performing database operation -&gt; Not recommended!</p>
<ul>
<li>Adopt the simple DAO pattern to communicate with persistence storage</li>
<li>DTO ç”¨äºåœ¨ä¸åŒçš„å±‚ï¼ˆå¦‚åº”ç”¨å±‚ã€ä¸šåŠ¡é€»è¾‘å±‚ã€è¡¨ç¤ºå±‚ç­‰ï¼‰ä¹‹é—´ä¼ è¾“æ•°æ®ï¼Œ</li>
<li>DAO å°è£…äº†ä¸æ•°æ®åº“äº¤äº’çš„ç»†èŠ‚ï¼Œæä¾›äº†ä¸€ç§æŠ½è±¡çš„æ¥å£</li>
</ul>
<h3>DAO</h3>
<ul>
<li>conain all collective behaviors(like a list obj)</li>
<li>contain the persistence related behaviours</li>
</ul>
<p>CREATE flow</p>
<ol>
<li>interface create a record OBJ</li>
<li>interface call controller</li>
<li>controller call DAO</li>
<li>DAO get the record OBJ</li>
<li>DAO store</li>
</ol>
<hr>
<p>failover provision æ•…éšœè½¬ç§»</p>

<h1>ã€ŒNestJSã€ æ•™ç¨‹äº† - åŸºç¡€çŸ¥è¯†å‡†å¤‡</h1><blockquote>
<p>æœ¬æ–‡ç”± <a href="http://ksria.com/simpread/">ç®€æ‚¦ SimpRead</a> è½¬ç ï¼Œ åŸæ–‡åœ°å€ <a href="https://juejin.cn/post/7078847428455530526?searchId=20230901115242BA94AF700DEF9495FDC5">juejin.cn</a></p>
</blockquote>
<h1>ç†è®ºçŸ¥è¯†</h1>
<p>Nest æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºé«˜æ•ˆï¼Œå¯æ‰©å±•çš„Â <a href="https://link.juejin.cn?target=http%3A%2F%2Fnodejs.cn%2F" title="http://nodejs.cn/">Node.js</a>Â æœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºçš„æ¡†æ¶ã€‚ å®ƒæ˜¯ä¸€ä¸ªåŠŸèƒ½æ¯”è¾ƒå…¨é¢çš„ Nodejs åç«¯æ¡†æ¶ï¼Œåº•å±‚æ”¯æŒ Express å’Œ Fastifyã€‚</p>
<h2>âš ï¸åœ¨ NestJS ä¸­ OOP çš„æ€æƒ³å¾ˆå¤š
èµ·æ­¥</h2>
<pre><code># æ²¡æœ‰åºŸè¯ï¼Œç›´æ¥ä¸Šä»£ç 
$ npm i -g @nestjs/cli 
$ nest new project-name
</code></pre>
<p>æˆ‘ä»¬å¯åŠ¨æ–‡æ¡£åœ¨å“ªå„¿å‘¢ï¼Ÿå®ƒåœ¨main.js</p>
<pre><code>import { NestFactory } from '@nestjs/core';
import { NestExpressApplication } from '@nestjs/platform-express';
import { AppModule } from './app.module';


async function bootstrap() {
  // const app = await NestFactory.create(AppModule);  
  // ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬é€‰æ‹© NestExpress ï¼Œå› ä¸ºç½‘ä¸Šå¯¹è¿™æ–¹é¢çš„èµ„æºå¤šï¼Œå‡ºbugå¥½æ‰¾è§£å†³æ–¹æ¡ˆï¼Œè€Œä¸”å®˜æ–¹æ–‡æ¡£æœ‰å¾ˆå¤šä¾‹å­éƒ½æ˜¯ Expressæ¥è¯´çš„
  const app = await NestFactory.create&lt;NestExpressApplication&gt;(AppModule);
  await app.listen(3000);
}
bootstrap();
</code></pre>
<h2>Controllerç†è®ºçŸ¥è¯†</h2>
<ul>
<li>è¢« @Controller è£…é¥°çš„ç±» å°±æ˜¯ ä¸€ä¸ª Controller ï¼Œ</li>
<li>åœ¨ module ä¸­æŠŠå®ƒå€’å…¥åˆ°å¯¹åº”çš„ controller ä¸­å°±èƒ½å¤Ÿä½¿ç”¨å®ƒ</li>
<li>å…¶åŠŸèƒ½æ˜¯ <strong>å¤„ç†ä¼ å…¥çš„è¯·æ±‚å’Œå‘å®¢æˆ·ç«¯è¿”å›å“åº”</strong>ã€‚</li>
</ul>
<h2>Controllerä»£ç </h2>
<pre><code>// app.controller.ts
// @Controller(â€˜helloâ€™) å½“ä½ è®¿é—®3000/helloçš„æ—¶å€™ä½ å°±èƒ½ å¯¼èˆª åˆ°è¿™ä¸ªcontrooleræ¥äº†
@Controller()
export class AppController {
}

</code></pre>
<h2>module é…ç½® controller</h2>
<pre><code>//app.module.ts
import { Module } from '@nestjs/common';
import { AppController } from './app.controller';
import { AppService } from './app.service';

@Module({
  imports: [],
  controllers: [AppController],  
  // è¿™ä¸ªå°±æ˜¯æŠŠ controlleræ”¾åœ¨è¿™ä¸ªé‡Œé¢å°±å¥½äº† é€šè¿‡@Module è£…é¥°å™¨å°†å…ƒæ•°æ®é™„åŠ åˆ°æ¨¡å—ç±»ä¸­ Nest å¯ä»¥è½»æ¾åå°„ï¼ˆreflectï¼‰å‡ºå“ªäº›æ§åˆ¶å™¨ï¼ˆcontrollerï¼‰å¿…é¡»è¢«å®‰è£…
  providers: [AppService],  // è¿™ä¸ªæˆ‘ä»¬æš‚ä¸”ä¸ç®¡
})
export class AppModule {}
</code></pre>
<h2>åœ¨ controller é‡Œé¢å®šä¹‰è·¯å¾„</h2>
<pre><code>// app.controller.ts
// æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ @Get @Put @Post @Delete æ¥å®šä¹‰ 
// å¦‚æœä½ ç»™ä»–ä¼ é€’äº†å‚æ•°å°±æ˜¯å®ƒçš„è·¯å¾„ 
// ç»“åˆå‰é¢çš„ä»£ç ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨getè®¿é—® 3000/hello/nihaoçš„æ—¶å€™å°±èƒ½å¾—åˆ° â€œä½ å¥½â€ stringçš„è¿”å›
@Controller(â€˜helloâ€™)
...
  @Get(â€˜/nihaoâ€™)
  getHello(): string {
    return â€œä½ å¥½â€;
  }
</code></pre>
<h2>åœ¨ controller é‡Œé¢è·å–å‚æ•°</h2>
<p>å¦‚æœä½ è°ƒç”¨äº†Req å’ŒResé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ä½ å°±éœ€è¦æ‰‹åŠ¨çš„res.sed()äº†ï¼Œä¸æ¨è
å¦‚æœä½ ç›´æ¥ è¿™æ ·åšå°†ä¼šå¯¼è‡´ å¤±å»ä¸ä¾èµ–äº Nest æ ‡å‡†å“åº”å¤„ç†çš„ Nest åŠŸèƒ½ï¼ˆä¾‹å¦‚ï¼Œæ‹¦æˆªå™¨ï¼ˆInterceptorsï¼‰ å’Œ @HttpCode()/@Header() è£…é¥°å™¨ï¼‰çš„å…¼å®¹æ€§
// è¦è§£å†³æ­¤é—®é¢˜ï¼Œå¯ä»¥å°† passthrough é€‰é¡¹è®¾ç½®ä¸º true æ¯”å¦‚ä¸‹é¢çš„å‡½æ•° â€œ/getReq2â€ è¿™æ ·å°±èƒ½å…¼å®¹ï¼Œä½ åªå®šä¹‰äº†code å…¶å®ƒçš„å®šä¹‰ä¾ç„¶äº¤ç”±Nestå¤„ç† æ¯”å¦‚ä¸‹é¢ğŸ‘‡ çš„åˆ—å­</p>
<pre><code>// 1. å¦‚ä½•è·å–req å’Œres å¯¹è±¡ï¼Œå¹¶ä¸”æ‰‹åŠ¨çš„è®¾ç½®å€¼ cookieä»€ä¹ˆä¹‹ç±»çš„
@Get(&quot;/getReq&quot;)
getReq( @Req() request: Request, @Res() response: Response ): any {
  console.log(request.headers);
  // HttpStatus.OKæ˜¯ä¸€ä¸ªæšä¸¾å€¼
  response.status(HttpStatus.OK).send();
}

@Get(&quot;/getReq2&quot;)
getReq2( @Req() request: Request, @Res({  passthrough: true }) response:Response ): any {
  response.status(HttpStatus.OK);
  return []
}
</code></pre>
<h2>åœ¨ controller é‡Œé¢è·å–getçš„queryå‚æ•°å’Œparmaå‚æ•°</h2>
<pre><code>@Get(&quot;getQueryAndParam/:id?&quot;)
getQuery( @Param(&quot;id&quot;) params: string  ,@Query() query: { value:number,qx:number }) :any {
    // å®é™…ä¸Šä½ å¯ä»¥ç›´æ¥é€šè¿‡reqå»æ‹¿ï¼Œå½“ç„¶é€šè¿‡æ³¨å…¥ä¹Ÿæ˜¯å¯ä»¥çš„
    console.log(&quot;params&quot;,params)
    console.log(&quot;query&quot;,query)
  return &quot;2222&quot;
}
</code></pre>
<h2>åœ¨ controller é‡Œé¢è·å–POST PUT ç­‰è¯·æ±‚çš„Bodyå‚æ•°</h2>
<pre><code>@Post(&quot;postQuery/:id?&quot;)
postQuery( @Param(&quot;id&quot;) params: string  ,@Body() body: { value:number,qx:number }) :any {
    // å®é™…ä¸Šä½ å¯ä»¥ç›´æ¥é€šè¿‡reqå»æ‹¿ï¼Œå½“ç„¶é€šè¿‡æ³¨å…¥ä¹Ÿæ˜¯å¯ä»¥çš„
    console.log(&quot;params&quot;,params)
    console.log(&quot;body&quot;,body)
  return &quot;PostQuery&quot;
}
</code></pre>
<h2>åœ¨ controller é‡Œé¢è‡ªå®šä¹‰çŠ¶æ€å—ï¼Œ</h2>
<p>å…¶å®éå¸¸çš„ç®€å• ä½¿ç”¨è£…é¥°å™¨æ³¨å…¥å°±å¥½äº†@HttpCode å¦å¤–åŒç±»å‹çš„è¿˜æœ‰ @Redirect</p>
<pre><code>@Get(&quot;userState&quot;)
@HttpCode(204)
@Header('Cache-Control', 'none')
userState( ) :any {
  return &quot;userState&quot;
}
</code></pre>
<h2>åœ¨ controller é‡Œé¢é‡å®šå‘</h2>
<pre><code>@Get('docs')
@Redirect('https://docs.nestjs.com', 302)
getDocs(@Query('version') version) {
  if (version &amp;&amp; version === '5') {
    return { url: 'https://docs.nestjs.com/v5/' };
  }
}
</code></pre>
<h2>æä¾›è€… Providers</h2>
<p>åœ¨ Nest ä¸­éšå¤„å¯è§çš„éƒ½æ˜¯ Providers ï¼Œæ¯”å¦‚æ‹¦æˆªå™¨å•Šï¼Œé…ç½®æ¨¡å—å•Šï¼Œä¸­é—´é—´
Provider åªæ˜¯ä¸€ä¸ªç”¨Â <code>@Injectable()</code>Â è£…é¥°å™¨æ³¨é‡Šçš„ç±»ã€‚
åœ¨ Nestjs å‡¡è¢« @Injectable è£…é¥°çš„ç±» éƒ½æ˜¯ Providers ï¼Œä»–ä»¬éƒ½å¯ä»¥é€šè¿‡Â <code>constructor</code>Â <strong>æ³¨å…¥</strong>ä¾èµ–å…³ç³»ã€‚
è¿™æ„å‘³ç€å¯¹è±¡å¯ä»¥å½¼æ­¤åˆ›å»ºå„ç§å…³ç³»ï¼Œå¹¶ä¸” â€œè¿æ¥â€ å¯¹è±¡å®ä¾‹çš„åŠŸèƒ½åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå¯ä»¥å§”æ‰˜ç»™Â <code>Nest</code>è¿è¡Œæ—¶ç³»ç»Ÿã€‚</p>
<h3>Providers ä½¿ç”¨</h3>
<pre><code>import { Injectable } from '@nestjs/common';

@Injectable()
export class AppService {
  getHello(): string {
    return 'Hello World!';
  }
}

</code></pre>
<p>å’Œcontroller ç±»ä¼¼ï¼Œä½ éœ€è¦åœ¨moduleå…¥å£åŠ å…¥åˆ°æŒ‡å®šçš„å¯¹è±¡ä¸­å»</p>
<pre><code>
@Module({
  imports: [],
  controllers: [AppController],  
  providers: [AppService],    // å£°æ˜provider
})
export class AppModule {}
</code></pre>
<h2>æ¨¡å— Module</h2>
<p>æ¨¡å—æ˜¯å…·æœ‰Â <code>@Module()</code>Â è£…é¥°å™¨çš„ç±»ã€‚
<code>@Module()</code>Â è£…é¥°å™¨æä¾›äº†å…ƒæ•°æ®ï¼ŒNest ç”¨å®ƒæ¥ç»„ç»‡åº”ç”¨ç¨‹åºç»“æ„ã€‚</p>
<h3>Module å¦‚ä½•ä½¿ç”¨</h3>
<p>å‡¡ è¢« <code>@module()</code>è£…é¥°çš„å°±æ˜¯ä¸€ä¸ª Module å®ƒå¯ä»¥æ¥å—ä¸‹é¢çš„å‚æ•°</p>
<pre><code>@Global()å¦‚æœä½ éœ€è¦æŠŠè¿™ä¸ªæ¨¡å— æš´éœ²åˆ°å…¨å±€ä½¿ç”¨å¯ä»¥åŠ  ä¸€ä¸ªè£…é¥°å™¨ @Global
@Module({ 
    controllers:[], // å‰é¢è¯´è¿‡
    imports:[], // å¯ä»¥æ³¨å…¥ å…¶ä»–module æˆ–è€…provider
    exports:[], // å¦‚æœä½ è¿™ä¸ªæ¨¡å—ä¸­çš„provider è¦åœ¨åˆ«çš„æ¨¡å—ä¸­ä½¿ç”¨ ä½ å¿…é¡»è¦åœ¨è¿™é‡Œå£°æ˜ å¯¼å‡ºè¿™é‹provider ï¼Œ
    providers:[]  // ç”± Nest æ³¨å…¥å™¨å®ä¾‹åŒ–çš„æä¾›è€…ï¼Œå¹¶ä¸”å¯ä»¥è‡³å°‘åœ¨æ•´ä¸ªæ¨¡å—ä¸­å…±äº«
})
</code></pre>

<h1>åˆè¯† node æ¡†æ¶ Nest.js</h1><blockquote>
<p>æœ¬æ–‡ç”± <a href="http://ksria.com/simpread/">ç®€æ‚¦ SimpRead</a> è½¬ç ï¼Œ åŸæ–‡åœ°å€ <a href="https://juejin.cn/post/7054421306845954056?searchId=20230901115242BA94AF700DEF9495FDC5">juejin.cn</a></p>
</blockquote>
<h1>åˆè¯† Nest</h1>
<h2>æ¡†æ¶ç®€ä»‹</h2>
<ul>
<li>Nest ç»“åˆäº† OOPï¼ˆé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼‰ï¼ŒFPï¼ˆå‡½æ•°å¼ç¼–ç¨‹ï¼‰å’Œ FRPï¼ˆå‡½æ•°å¼å“åº”ç¼–ç¨‹ï¼‰çš„å…ƒç´ ã€‚</li>
<li>Nest æ¡†æ¶åº•å±‚ HTTP å¹³å°é»˜è®¤æ˜¯åŸºäº Express å®ç°çš„ï¼Œæ‰€ä»¥æ— éœ€æ‹…å¿ƒç¬¬ä¸‰æ–¹åº“çš„ç¼ºå¤±ã€‚</li>
<li>Nest æ—¨åœ¨æˆä¸ºä¸€ä¸ªä¸å¹³å°æ— å…³çš„æ¡†æ¶ã€‚</li>
<li>nest ç›®å‰æœ‰ä¸¤ä¸ªæ”¯æŒå¼€ç®±å³ç”¨çš„ HTTP å¹³å°ï¼šexpress å’Œ fastify å¯ä»¥åœ¨é¡¹ç›®ä¸­ç›´æ¥å¼•å…¥ã€‚</li>
</ul>
<h2>ä¸åŒçš„ Node åç«¯</h2>
<ul>
<li>Koa.js æ˜¯ä¸€æ¬¾å¾®å‹ Web æ¡†æ¶ï¼Œå†™ä¸€ä¸ª hello world å¾ˆç®€å•ï¼Œä½† web åº”ç”¨ç¦»ä¸å¼€ sessionï¼Œè§†å›¾æ¨¡æ¿ï¼Œè·¯ç”±ï¼Œæ–‡ä»¶ä¸Šä¼ ï¼Œæ—¥å¿—ç®¡ç†ã€‚è¿™äº› Koa éƒ½ä¸æä¾›ï¼Œéœ€è¦è‡ªè¡Œå»å®˜æ–¹çš„ Middleware å¯»æ‰¾ã€‚ç„¶è€Œï¼Œ100 ä¸ªäººå¯èƒ½æ‰¾å‡º 100 ç§æ­é…ã€‚</li>
<li>Egg.js æ˜¯åŸºäº Koa.jsï¼Œè§£å†³äº†ä¸Šè¿°é—®é¢˜ï¼Œå°†ç¤¾åŒºæœ€ä½³å®è·µæ•´åˆè¿›äº† Koa.jsï¼Œå¦å–åå« Egg.jsï¼Œå¹¶ä¸”å°†å¤šè¿›ç¨‹å¯åŠ¨ï¼Œå¼€å‘æ—¶çš„çƒ­æ›´æ–°ç­‰é—®é¢˜ä¸€å¹¶è§£å†³äº†ã€‚è¿™å¯¹å¼€å‘è€…å¾ˆå‹å¥½ï¼Œå¼€ç®±å³ç”¨ï¼Œå¼€ç®±å³æ˜¯æœ€ (è¾ƒ) ä½³é…ç½®ã€‚Egg.js å‘å±•æœŸé—´ï¼ŒECMAScript åˆæ¨å‡ºäº† async awaitï¼Œç›¸æ¯” yield çš„è¯­æ³• async å†™èµ·æ¥æ›´ç›´ã€‚åé¢ Koa.js ä¹ŸåŒæ­¥è¿›è¡Œäº†è·Ÿè¿›ã€‚</li>
<li>Midway æ˜¯é˜¿é‡Œå›¢é˜Ÿï¼ŒåŸºäºæ¸è¿›å¼ç†å¿µç ”å‘çš„ Node.js æ¡†æ¶ï¼Œç»“åˆäº† OOP å’Œå‡½æ•°å¼ä¸¤ç§ç¼–ç¨‹èŒƒå¼ã€‚ä»¥ egg æ˜¯ä½œä¸ºåº•å±‚æ¡†æ¶ï¼ŒåŠ ä¸Šäº†è‰¯å¥½çš„ TypeScript çš„å®šä¹‰æ”¯æŒç­‰ä¼—å¤šæ–°ç‰¹æ€§, æ¨å‡ºäº† Midwayï¼Œæœ‰å…´è¶£çš„å°ä¼™ä¼´å¯ä»¥å»å®˜æ–¹æ–‡æ¡£å­¦ä¹ ä¸€ä¸‹</li>
</ul>
<h4>åˆ›å»ºé¡¹ç›®</h4>
<ul>
<li>$  npm i -g @nestjs/cli
$  nest new project-name</li>
<li></li>
</ul>
<h2>Next æ ¸å¿ƒæ–‡ä»¶çš„ç®€å•æè¿°:</h2>
<p><img src="file://Mac/Home/myGitHubMac/simple-read/_resources/7bd802c69b0933b42b28591db9dca273_MD5.webp" /></p>
<table><thead><tr><td>app.controller.ts</td><td>å¸¦æœ‰å•ä¸ªè·¯ç”±çš„åŸºæœ¬æ§åˆ¶å™¨ç¤ºä¾‹</td></tr></thead><tbody><tr><td>app.controller.spec.ts</td><td>å¯¹äºåŸºæœ¬æ§åˆ¶å™¨çš„å•å…ƒæµ‹è¯•æ ·ä¾‹</td></tr><tr><td>app.module.ts</td><td>åº”ç”¨ç¨‹åºçš„æ ¹æ¨¡å—ã€‚</td></tr><tr><td>app.service.ts</td><td>å¸¦æœ‰å•ä¸ªæ–¹æ³•çš„åŸºæœ¬æœåŠ¡</td></tr><tr><td>main.ts</td><td>åº”ç”¨ç¨‹åºå…¥å£æ–‡ä»¶ã€‚ç”¨æ¥åˆ›å»º Nest åº”ç”¨å®ä¾‹ã€‚</td></tr></tbody></table>
<pre><code>/* main.ts */
import { NestFactory } from '@nestjs/core';
import { AppModule } from './app.module';

async function bootstrap() {
  const app = await NestFactory.create(AppModule); // ä½¿ç”¨æ ¸å¿ƒç±» NestFactory è¿”å›ä¸€ä¸ª æ¥å£å¯¹è±¡
  await app.listen(3000);  // è¿™é‡Œæ˜¯é»˜è®¤è®¾ç½®çš„ç«¯å£å·
}
bootstrap();
</code></pre>
<h4>è¿è¡Œé¡¹ç›®</h4>
<p>$ npm run start:watch // å¯åŠ¨é¡¹ç›®å¹¶ç›‘å¬ä»£ç å˜åŠ¨
è¿™é‡Œå¯ä»¥åœ¨package.json ä¸­è¿›è¡Œé…ç½®æŒ‡ä»¤
æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœåŠ¡å·²ç»å¯åŠ¨,è¾“å…¥æœ¬æœºåœ°å€å¹¶å¸¦ä¸Šç«¯å£å·3000,å‘é€ä¸€æ¬¡ get è¯·æ±‚ åˆ™ä¼šè¿”å› <code>Hello World</code>ã€‚<br>
è¿™é‡Œæ˜¯å› ä¸ºåœ¨ app.controll.ts æ–‡ä»¶ä¸­ @Get()HTTPè¯·æ±‚è£…é¥°å™¨å‘Šè¯‰Nestä¸ºHTTPè¯·æ±‚çš„ç‰¹å®šç«¯ç‚¹åˆ›å»ºå¤„ç†ç¨‹åºã€‚</p>
<h2>è·¯ç”±</h2>
<ul>
<li>
<p>åœ¨å¼€å§‹å†™ä»£ç ä¹‹å‰æˆ‘ä»¬å…ˆç®€å•çœ‹ä¸€ä¸‹ nest ä¸­çš„åŸºç¡€è·¯ç”±é…ç½®æ˜¯æ€æ ·çš„ï¼Œå°±ç›®å‰è€Œè¨€æˆ‘çš„ç†è§£ä¸º nest çš„è·¯ç”±æ˜¯ç”± å…¨å±€è·¯ç”± è·¯ç”±å‰ç¼€ (å±€éƒ¨è·¯ç”±) æ–¹æ³•è£…é¥°å™¨ ç»„æˆè·¯ç”±æ˜ å°„æä¾›ç»™å‰ç«¯ä½¿ç”¨ã€‚</p>
</li>
<li>
<pre><code>/* main.ts */
 mainæ–‡ä»¶ä¸­æˆ‘ä»¬å¯ä»¥åœ¨é¡¹ç›®ç›‘å¬å‰é…ç½®ä¸€ä¸ªå…¨å±€çš„apiå‰ç¼€
async function bootstrap() {
const app = await NestFactory.create(AppModule);
    //è®¾ç½®å…¨å±€å‰ç¼€
    app.setGlobalPrefix('api');
    await app.listen(3000);
  }
/* app.controller.ts */
@Controller('user') // æ§åˆ¶å™¨è®¾ç½®è·¯ç”±å‰ç¼€ æˆ‘ç†è§£ä¸ºå±€éƒ¨è·¯ç”±
  export class AppController {
    constructor(private readonly appService: AppService) {}
    @Get('find') // æ–¹æ³•è£…é¥°å™¨è®¾ç½®è·¯ç”±è·¯å¾„ è¿™é‡Œæˆ‘ç†è§£ä¸ºè®¾ç½®apiå­è·¯ç”±
    getHello(): string {
      return this.appService.getHello();
        }
    }
</code></pre>
</li>
<li>
<p>ä»¥ä¸Šæ–¹æ³•åœ¨ api ä¸­æ˜ å°„æˆå®Œæ•´çš„è·¯ç”±ä¸º <code>GET api/user/find</code> ã€‚</p>
</li>
<li>
<p>å…¶ä¸­ @Get()HTTP è¯·æ±‚è£…é¥°å™¨å‘Šè¯‰ Nest ä¸º HTTP è¯·æ±‚çš„ç‰¹å®šç«¯ç‚¹åˆ›å»ºå¤„ç†ç¨‹åºã€‚</p>
</li>
</ul>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e330a77665304aa9a0439378ad5c28de~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?" alt=""></p>
<ul>
<li>å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„ <code>get</code> æ¥æ”¶è¯·æ±‚åŠè·¯ç”±ä»¥å¯ä»¥ä½¿ç”¨ï¼Œä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸‹ <code>nest</code> ä¸­å¦‚ä½•æ¥æ”¶ <code>post</code> ç­‰å…¶ä»–è¯·æ±‚æ–¹å¼</li>
</ul>
<h2>ä¸åŒæ–¹å¼æ¥æ”¶è¯·æ±‚</h2>
<ul>
<li>
<p>è¿™é‡Œç”¨åˆ°çš„ Nest æä¾›çš„è¯·æ±‚è£…é¥°å™¨çŸ¥è¯†ç‚¹ <code>Request</code>Â å¯¹è±¡ä»£è¡¨Â <code>HTTP</code>Â è¯·æ±‚ï¼Œå¹¶å…·æœ‰æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œè¯·æ±‚å‚æ•°å‚æ•°ï¼ŒHTTP æ ‡å¤´ï¼ˆHTTP headerï¼‰ å’Œ æ­£æ–‡ï¼ˆHTTP bodyï¼‰çš„å±æ€§ï¼ˆåœ¨<a href="https://link.juejin.cn?target=https%3A%2F%2Fexpressjs.com%2Fen%2Fapi.html%23req" title="https://expressjs.com/en/api.html#req">è¿™é‡Œ</a>é˜…è¯»æ›´å¤šï¼‰ã€‚åœ¨å¤šæ•°æƒ…å†µä¸‹ï¼Œä¸å¿…æ‰‹åŠ¨è·å–å®ƒä»¬ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸“ç”¨çš„è£…é¥°å™¨ï¼Œæ¯”å¦‚å¼€ç®±å³ç”¨çš„Â <code>@Body()</code>Â æˆ–Â <code>@Query()</code>Â ã€‚ ä¸‹é¢æ˜¯ Nest æä¾›çš„è£…é¥°å™¨åŠå…¶ä»£è¡¨çš„åº•å±‚å¹³å°ç‰¹å®šå¯¹è±¡çš„å¯¹ç…§åˆ—è¡¨ã€‚</p>
</li>
<li>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/530021517f3e4d2f83d4f3c563bcf645~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp?" alt=""></p>
</li>
<li>
<p>ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸‹ nest ä¸­å¦‚ä½•æ¥æ”¶ <code>get post put delete</code> å‘èµ·çš„è¯·æ±‚ï¼Œç”¨å‡ ä¸ªå¯ç”¨çš„è£…é¥°å™¨æ¥åˆ›å»ºåŸºæœ¬æ§åˆ¶å™¨ã€‚ è¯¥æ§åˆ¶å™¨æš´éœ²äº†å‡ ä¸ªè®¿é—®å’Œæ“ä½œå†…éƒ¨æ•°æ®çš„æ–¹æ³•ã€‚</p>
</li>
</ul>
<h3>Get</h3>
<p>æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ª user æœåŠ¡</p>
<pre><code>/ * user.service.ts  */ å…ˆåˆ›å»ºä¸€ä¸ª user serviceæœåŠ¡æ–‡ä»¶
import { Injectable } from '@nestjs/common';
   @Injectable() // 
   // è¿™é‡Œ
   export class UserService {
	 findUser(sid: string): string {
	   console.log(sid);
	   if (sid === '123456') {
		 return 'kid is here';
	   }
	   return 'No one here';
	 }
  }
</code></pre>
<ul>
<li>è¯¥æœåŠ¡å°†è´Ÿè´£æ•°æ®å­˜å‚¨å’Œæ£€ç´¢ï¼Œå…¶ç”±Â <code>UserController</code>Â ä½¿ç”¨ï¼Œæˆ‘ä»¬ç”¨Â <code>@Injectable()</code>Â æ¥è£…é¥°è¿™ä¸ªç±»</li>
</ul>
<p>åˆ›å»ºä¸€ä¸ªæ§åˆ¶å™¨</p>
<pre><code>/ * user.controller.ts  */ åˆ›å»ºä¸€ä¸ª user æ§åˆ¶å™¨æ–‡ä»¶
import { Controller, Get, Query } from '@nestjs/common';
import { UserService } from './user.service';

@Controller('user')
export class UserController {
   constructor(private readonly userService: UserService) {}
   @Get('findOne') //è¿™é‡Œæš´éœ²å‡ºçš„è·¯ç”±ä¸º user/find
   findUser(@Query() query: any) {
	 return this.userService.findUser(query.sid);
   }
</code></pre>
<ul>
<li>æ§åˆ¶å™¨çš„ç›®çš„æ˜¯æ¥æ”¶åº”ç”¨çš„ç‰¹å®šè¯·æ±‚ã€‚<strong>è·¯ç”±</strong>æœºåˆ¶æ§åˆ¶å“ªä¸ªæ§åˆ¶å™¨æ¥æ”¶å“ªäº›è¯·æ±‚ã€‚é€šå¸¸ï¼Œæ¯ä¸ªæ§åˆ¶å™¨æœ‰å¤šä¸ªè·¯ç”±ï¼Œä¸åŒçš„è·¯ç”±å¯ä»¥æ‰§è¡Œä¸åŒçš„æ“ä½œã€‚</li>
<li>ä¸ºäº†åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„æ§åˆ¶å™¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ç±»å’Œ<code>è£…é¥°å™¨</code>ã€‚è£…é¥°å™¨å°†ç±»ä¸æ‰€éœ€çš„å…ƒæ•°æ®ç›¸å…³è”ï¼Œå¹¶ä½¿ Nest èƒ½å¤Ÿåˆ›å»ºè·¯ç”±æ˜ å°„ï¼ˆå°†è¯·æ±‚ç»‘å®šåˆ°ç›¸åº”çš„æ§åˆ¶å™¨ï¼‰ã€‚</li>
</ul>
<p>åˆ›å»ºä¸€ä¸ª/ moudle</p>
<pre><code>/ * user.module.ts  */ åˆ›å»ºä¸€ä¸ª user mod
 import { Module } from '@nestjs/common';
 import { UserController } from './user.controller';
 import { UserService } from './user.service';
 @Module({
	 controllers: [UserController],
	 providers: [UserService],
   })
   export class UserModule {}

/*  app.module.ts  */ æœ€ååœ¨app.moduleä¸­å¼•å…¥æˆ‘ä»¬è‡ªå·±å†™çš„module
import { Module } from '@nestjs/common';
import { AppController } from './app.controller';
import { AppService } from './app.service';
import { UserModule } from './user/user.module';

@Module({
	 imports: [UserModule],
	 controllers: [AppController],
	 providers: [AppService],
   })
   export class AppModule {}
</code></pre>
<ul>
<li>æ§åˆ¶å™¨å·²ç»å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯ Nest ä¾ç„¶ä¸çŸ¥é“Â <code>UserController</code>Â æ˜¯å¦å­˜åœ¨ï¼Œæ‰€ä»¥å®ƒä¸ä¼šåˆ›å»ºè¿™ä¸ªç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚</li>
<li>æ§åˆ¶å™¨æ€»æ˜¯å±äºæ¨¡å—ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨Â <code>@Module()</code>Â è£…é¥°å™¨ä¸­åŒ…å«Â <code>controllers</code>Â æ•°ç»„çš„åŸå› ã€‚ ç”±äºé™¤äº†æ ¹æ¨¡å—Â <code>AppModule</code>ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰å®šä¹‰å…¶ä»–æ¨¡å—ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ä½¿ç”¨å®ƒæ¥ä»‹ç»Â <code>UserController</code></li>
</ul>
<h3>Post</h3>
<ul>
<li>user.service æ–‡ä»¶<pre><code>/ * user.service.ts  */ å…ˆåˆ›å»ºä¸€ä¸ª user serviceæœåŠ¡æ–‡ä»¶
import { Injectable } from '@nestjs/common';
   @Injectable() // 
   // è¿™é‡Œ
  setUser(sid: string, body: any): any {
       if (sid === '123456') {
         return {
           msg: 'è®¾ç½®æˆåŠŸ',
           body,
         };
     }
  }
</code></pre>
</li>
<li>user.controller æ–‡ä»¶<pre><code>/ * user.controller.ts  */ åˆ›å»ºä¸€ä¸ª user æ§åˆ¶å™¨æ–‡ä»¶
import { Controller, Get, Query } from '@nestjs/common';
import { UserService } from './user.service';

@Controller('user')
export class UserService {
    @Post('set')
    setUser(@Body() body: any, @Query() query: any) {
      return this.userService.setUser(query.sid, body);
    } 
}
</code></pre>
</li>
</ul>
<h3>Put</h3>
<ul>
<li>user.service æ–‡ä»¶</li>
</ul>
<pre><code>/ * user.service.ts  */ å…ˆåˆ›å»ºä¸€ä¸ª user serviceæœåŠ¡æ–‡ä»¶
import { Injectable } from '@nestjs/common';
   @Injectable() // 
   // è¿™é‡Œ
  updateUser(sid: string, body: any): any {
	   if (sid === '123456') {
		 return {
		   msg: 'è®¾ç½®æˆåŠŸ',
		   body,
		 };
	 }
  }
</code></pre>
<p>user.controller æ–‡ä»¶</p>
<ul>
<li>è¿™é‡Œç”¨åˆ°äº† Param è£…é¥°å™¨ <code>@Param()</code>Â ç”¨äºä¿®é¥°ä¸€ä¸ªæ–¹æ³•çš„å‚æ•°ï¼ˆä¸Šé¢ç¤ºä¾‹ä¸­çš„Â <code>params</code>ï¼‰ï¼Œå¹¶åœ¨è¯¥æ–¹æ³•å†…å°†<strong>è·¯ç”±å‚æ•°</strong>ä½œä¸ºè¢«ä¿®é¥°çš„æ–¹æ³•å‚æ•°çš„å±æ€§ã€‚</li>
</ul>
<ul>
<li>
<p>å¦‚ä¸Šé¢çš„ä»£ç æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¼•ç”¨Â <code>params.id</code>æ¥è®¿é—®ï¼ˆè·¯ç”±è·¯å¾„ä¸­çš„ï¼‰Â <code>id</code>Â å‚æ•°ã€‚ æ‚¨è¿˜å¯ä»¥å°†ç‰¹å®šçš„å‚æ•°æ ‡è®°ä¼ é€’ç»™è£…é¥°å™¨ï¼Œç„¶ååœ¨æ–¹æ³•ä¸»ä½“ä¸­æŒ‰å‚æ•°åç§°ç›´æ¥å¼•ç”¨è·¯ç”±å‚æ•°ã€‚</p>
<pre><code>/ * user.controller.ts  */ åˆ›å»ºä¸€ä¸ª user æ§åˆ¶å™¨æ–‡ä»¶
import { Body, Controller, Get, Param, Post, Put, Query } from '@nestjs/common';
import { UserService } from './user.service';

@Controller('user')
export class UserService {
   @Put(':sid')
   updateUser(@Param('sid') sid: string, @Body() body: any) {
     return this.userService.updateUser(sid, body);
   }
}
</code></pre>
</li>
</ul>
<h3>Delete</h3>
<ul>
<li>
<p>user.service æ–‡ä»¶</p>
<pre><code>/ * user.service.ts  */ å…ˆåˆ›å»ºä¸€ä¸ª user serviceæœåŠ¡æ–‡ä»¶
import { Injectable } from '@nestjs/common';
   @Injectable() // 
   // è¿™é‡Œ
 deleteUser(sid: string): any {
       if (sid === '123456') {
         return {
           msg: 'åˆ é™¤æˆåŠŸ',
         };
     }
  }
</code></pre>
</li>
<li>
<p>user.controller æ–‡ä»¶</p>
<pre><code>/ * user.controller.ts  */ åˆ›å»ºä¸€ä¸ª user æ§åˆ¶å™¨æ–‡ä»¶
import { Body, Controller, Get, Param, Post, Put, Query } from '@nestjs/common';
import { UserService } from './user.service';

@Controller('user')
export class UserService {
   @Delete(':sid')
   deleteUser(@Param('sid') sid: string) {
     return this.userService.deleteUser(sid);
   }
}
</code></pre>
</li>
</ul>

<h1>å­¦å®Œè¿™ç¯‡ Nest.js å®æˆ˜ï¼Œè¿˜æ²¡å…¥é—¨çš„æ¥é”¤æˆ‘ï¼(é•¿æ–‡é¢„è­¦)</h1><blockquote>
<p>æœ¬æ–‡ç”± <a href="http://ksria.com/simpread/">ç®€æ‚¦ SimpRead</a> è½¬ç ï¼Œ åŸæ–‡åœ°å€ <a href="https://juejin.cn/post/7032079740982788132?searchId=20230901115242BA94AF700DEF9495FDC5">juejin.cn</a></p>
</blockquote>
<h2>åˆè¯† Nest.js</h2>
<p>Nest åœ¨è¿™äº›å¸¸è§çš„ Node.js æ¡†æ¶ (Express/Fastify) ä¹‹ä¸Šæé«˜äº†ä¸€ä¸ªæŠ½è±¡çº§åˆ«ï¼Œä½†ä»ç„¶å‘å¼€å‘è€…ç›´æ¥æš´éœ²äº†åº•å±‚æ¡†æ¶çš„ APIã€‚è¿™ä½¿å¾—å¼€å‘è€…å¯ä»¥è‡ªç”±åœ°ä½¿ç”¨é€‚ç”¨äºåº•å±‚å¹³å°çš„æ— æ•°çš„ç¬¬ä¸‰æ–¹æ¨¡å—ã€‚</p>
<p><code>AngularJS</code>ã€<code>Spring</code>å’Œ<code>Nest.js</code>éƒ½æ˜¯åŸºäº<code>æ§åˆ¶åè½¬</code>åŸåˆ™è®¾è®¡çš„, è€Œä¸”éƒ½ä½¿ç”¨äº†ä¾èµ–æ³¨å…¥çš„æ–¹å¼æ¥è§£å†³è§£è€¦é—®é¢˜ã€‚</p>
<h3>ç¬¬ä¸€ä¸ªæ¥å£</h3>
<p>é¦–å…ˆå°±æ˜¯æ‰¾åˆ°å…¥å£æ–‡ä»¶<code>main.ts</code></p>
<pre><code>import { NestFactory } from '@nestjs/core';
import { AppModule } from './app.module';

async function bootstrap() {
  const app = await NestFactory.create(AppModule);
  await app.listen(3000);
}
bootstrap();
</code></pre>
<p>è¯´æ˜<code>Nest.js</code>åˆ›å»ºé¡¹ç›®é»˜è®¤å°±ç»™å†™äº†ä¸€ä¸ªæ¥å£ä¾‹å­ã€
ä½¿ç”¨<code>Nest.js</code>çš„å·¥å‚å‡½æ•°<code>NestFactory</code>æ¥åˆ›å»ºäº†ä¸€ä¸ª<code>AppModule</code>å®ä¾‹ï¼Œå¯åŠ¨äº† HTTP ä¾¦å¬å™¨ï¼Œä»¥ä¾¦å¬<code>main.ts</code> ä¸­æ‰€å®šä¹‰çš„ç«¯å£ã€‚</p>
<hr>
<p>æŸ¥çœ‹<code>AppModule</code>, æ‰“å¼€<code>src/app.module.ts</code>:</p>
<pre><code>import { Module } from '@nestjs/common';
import { AppController } from './app.controller';
import { AppService } from './app.service';

@Module({
  imports: [],
  controllers: [AppController],
  providers: [AppService],
})
export class AppModule {}
</code></pre>
<p><code>AppModule</code>æ˜¯åº”ç”¨ç¨‹åºçš„æ ¹æ¨¡å—ï¼Œæ ¹æ¨¡å—æä¾›äº†ç”¨æ¥å¯åŠ¨åº”ç”¨çš„å¼•å¯¼æœºåˆ¶ï¼Œå¯ä»¥åŒ…å«å¾ˆå¤šåŠŸèƒ½æ¨¡å—ã€‚muduleæ–‡ä»¶éœ€è¦ä½¿ç”¨ä¸€ä¸ª<code>@Module()</code> è£…é¥°å™¨çš„ç±»ï¼Œ</p>
<hr>
<p><code>@Module()</code> è£…é¥°å™¨æ¥æ”¶å››ä¸ªå±æ€§ï¼š<code>providers</code>ã€<code>controllers</code>ã€<code>imports</code>ã€<code>exports</code>ã€‚</p>
<ul>
<li>providersï¼š<code>Nest.js</code>æ³¨å…¥å™¨å®ä¾‹åŒ–çš„æä¾›è€…ï¼ˆæœåŠ¡æä¾›è€…ï¼‰ï¼Œå¤„ç†å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ï¼Œå„ä¸ªæ¨¡å—ä¹‹é—´å¯ä»¥å…±äº«ï¼›</li>
<li>controllersï¼šå¤„ç† http è¯·æ±‚ï¼ŒåŒ…æ‹¬è·¯ç”±æ§åˆ¶ï¼Œå‘å®¢æˆ·ç«¯è¿”å›å“åº”ï¼Œå°†å…·ä½“ä¸šåŠ¡é€»è¾‘å§”æ‰˜ç»™ providers å¤„ç†ï¼›</li>
<li>importsï¼šå¯¼å…¥æ¨¡å—çš„åˆ—è¡¨ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨å…¶ä»–æ¨¡å—çš„æœåŠ¡ï¼Œéœ€è¦é€šè¿‡è¿™é‡Œå¯¼å…¥ï¼›</li>
<li>exportsï¼šå¯¼å‡ºæœåŠ¡çš„åˆ—è¡¨ï¼Œä¾›å…¶ä»–æ¨¡å—å¯¼å…¥ä½¿ç”¨ã€‚å¦‚æœå¸Œæœ›å½“å‰æ¨¡å—ä¸‹çš„æœåŠ¡å¯ä»¥è¢«å…¶ä»–æ¨¡å—å…±äº«ï¼Œéœ€è¦åœ¨è¿™é‡Œé…ç½®å¯¼å‡ºï¼›</li>
</ul>
<hr>
<p>åœ¨<code>app.module.ts</code>ä¸­ï¼Œçœ‹åˆ°å®ƒå¼•å…¥äº†<code>app.controller.ts</code>å’Œ<code>app.service.ts</code>ï¼Œåˆ†åˆ«çœ‹ä¸€ä¸‹è¿™ä¸¤ä¸ªæ–‡ä»¶ï¼š</p>
<p>ä½¿ç”¨<code>@Controller</code>è£…é¥°å™¨æ¥å®šä¹‰æ§åˆ¶å™¨, <code>@Get</code>æ˜¯è¯·æ±‚æ–¹æ³•çš„è£…é¥°å™¨ï¼Œå¯¹<code>getHello</code>æ–¹æ³•è¿›è¡Œä¿®é¥°ï¼Œ è¡¨ç¤ºè¿™ä¸ªæ–¹æ³•ä¼šè¢« GET è¯·æ±‚è°ƒç”¨ã€‚</p>
<pre><code>// app.controller.ts
import { Controller, Get } from '@nestjs/common';
import { AppService } from './app.service';

@Controller()
export class AppController {
  constructor(private readonly appService: AppService) {}

  @Get()
  getHello(): string {
    return this.appService.getHello();
  }
}
</code></pre>
<p>æˆ‘ä»¬å¯ä»¥çœ‹å‡ºä½¿ç”¨<code>@Injectable</code>ä¿®é¥°åçš„ <code>AppService</code>, åœ¨<code>AppModule</code>ä¸­æ³¨å†Œä¹‹åï¼Œåœ¨<code>app.controller.ts</code>ä¸­ä½¿ç”¨ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦ä½¿ç”¨<code>new AppService()</code>å»å®ä¾‹åŒ–ï¼Œç›´æ¥å¼•å…¥è¿‡æ¥å°±å¯ä»¥ç”¨ã€‚</p>
<pre><code>// app.service.ts
import { Injectable } from '@nestjs/common';

@Injectable()
export class AppService { 
  getHello(): string {
    return 'Hello World!';
  }
}
</code></pre>
<h2>è·¯ç”±è£…é¥°å™¨</h2>
<p><code>Nest.js</code>ä¸­æ²¡æœ‰å•ç‹¬é…ç½®è·¯ç”±çš„åœ°æ–¹ï¼Œè€Œæ˜¯ä½¿ç”¨è£…é¥°å™¨ã€‚<code>Nest.js</code>ä¸­å®šä¹‰äº†è‹¥å¹²çš„è£…é¥°å™¨ç”¨äºå¤„ç†è·¯ç”±ã€‚</p>
<h3>@Controller</h3>
<p>å¦‚æ¯ä¸€ä¸ªè¦æˆä¸ºæ§åˆ¶å™¨çš„ç±»ï¼Œéƒ½éœ€è¦å€ŸåŠ©<code>@Controller</code>è£…é¥°å™¨çš„è£…é¥°ï¼Œ
è¯¥è£…é¥°å™¨å¯ä»¥ä¼ å…¥ä¸€ä¸ªè·¯å¾„å‚æ•°ï¼Œä½œä¸ºè®¿é—®è¿™ä¸ªæ§åˆ¶å™¨çš„ä¸»è·¯å¾„ï¼š
å¯¹<code>app.controller.ts</code>æ–‡ä»¶è¿›è¡Œä¿®æ”¹</p>
<pre><code>// ä¸»è·¯å¾„ä¸º app
@Controller(&quot;app&quot;)
export class AppController {
  constructor(private readonly appService: AppService) {}

  @Get()
  getHello(): string {
    return this.appService.getHello();
  }
}
</code></pre>
<p>æ­¤æ—¶å¯ä»¥é€šè¿‡<code>http://localhost:9080/app</code>æ¥è®¿é—®ã€‚</p>
<h3>HTTP æ–¹æ³•å¤„ç†è£…é¥°å™¨</h3>
<p><code>@Get</code>ã€<code>@Post</code>ã€<code>@Put</code>ç­‰ä¼—å¤šç”¨äº HTTP æ–¹æ³•å¤„ç†è£…é¥°å™¨ï¼Œç»è¿‡å®ƒä»¬è£…é¥°çš„æ–¹æ³•ï¼Œå¯ä»¥å¯¹ç›¸åº”çš„ HTTP è¯·æ±‚è¿›è¡Œå“åº”ã€‚
å®ƒä»¬å¯ä»¥æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ä½œä¸ºå‚æ•°ï¼Œè¿™é‡Œçš„<strong>å­—ç¬¦ä¸²</strong>å¯ä»¥æ˜¯å›ºå®šçš„è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯é€šé…ç¬¦ã€‚</p>
<p>ç»§ç»­ä¿®æ”¹<code>app.controller.ts</code>ï¼Œçœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<pre><code>// ä¸»è·¯å¾„ä¸º app
@Controller(&quot;app&quot;)
export class AppController {
  constructor(private readonly appService: AppService) {}
  // 2.é€šé…ç¬¦è·¯å¾„(?+* ä¸‰ç§é€šé…ç¬¦ )
  // å¯ä»¥åŒ¹é…åˆ° getè¯·æ±‚, http://localhost:9080/app/user_xxx
  @Get(&quot;user_*&quot;)
  getUser(){return &quot;getUser&quot;}
  
  // 3.å¸¦å‚æ•°è·¯å¾„
  // å¯ä»¥åŒ¹é…åˆ°putè¯·æ±‚ï¼Œhttp://localhost:9080/app/list/xxxx
  @Put(&quot;list/:id&quot;)
  update(){ return &quot;update&quot;}
}
</code></pre>
<hr>
<p>ç”±äºä¿®æ”¹äº†æ–‡ä»¶ï¼Œ éœ€è¦é‡å¯æ‰èƒ½çœ‹åˆ°è·¯ç”±ï¼Œ æ¯æ¬¡éƒ½é‡å¯ç®€ç›´å°±æ˜¯å™©æ¢¦ï¼Œæœ¬æ¥æ‰“ç®—é…ç½®ä¸€ä¸ªå®æ—¶ç›‘å¬æ–‡ä»¶å˜åŒ–ï¼Œå‘ç°<code>Nest.js</code>éå¸¸è´´å¿ƒçš„é…ç½®å¥½äº†ï¼Œ æˆ‘ä»¬åªè¦è¿è¡Œå‘½ä»¤å³å¯ï¼š</p>
<pre><code>npm run start:dev
</code></pre>
<p>è¿™æ ·å†ä¿®æ”¹ä»€ä¹ˆå†…å®¹ï¼Œ ä¿å­˜åéƒ½ä¼šè‡ªåŠ¨é‡å¯æœåŠ¡äº†ã€‚</p>
<hr>
<p>å…³äºè·¯ç”±åŒ¹é…æ—¶çš„æ³¨æ„ç‚¹ï¼Œ å½“æˆ‘ä»¬æœ‰ä¸€ä¸ª put è¯·æ±‚ï¼Œè·¯å¾„ä¸º<code>/app/list/user</code>, æ­¤æ—¶ï¼Œæˆ‘ä»¬åœ¨<code>app.controller.ts</code>æ§åˆ¶å™¨æ–‡ä»¶ä¸­å¢åŠ ä¸€ä¸ªæ–¹æ³•ï¼š</p>
<pre><code>@Put(&quot;list/user&quot;)
 updateUser(){
      return {userId:1}
  }
</code></pre>
<p>ä½ è§‰å¾—è¿™ä¸ªè·¯ç”±ä¼šè¢«åŒ¹é…åˆ°å—ï¼Ÿæˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ï¼š
å‘ç°<code>/app/list/user</code>åŒ¹é…åˆ°çš„å¹¶ä¸æ˜¯<code>updateUser</code>æ–¹æ³•ï¼Œ è€Œæ˜¯<code>update</code>æ–¹æ³•ã€‚è¿™å°±æ˜¯æˆ‘è¦è¯´çš„æ³¨æ„ç‚¹ã€‚</p>
<blockquote>
<p>å¦‚æœå› ä¸ºåœ¨åŒ¹é…è¿‡ç¨‹ä¸­ï¼Œ å‘ç°<code>@Put(&quot;list/:id&quot;)</code>å·²ç»æ»¡è¶³äº†, å°±ä¸ä¼šç»§ç»­å¾€ä¸‹åŒ¹é…äº†ï¼Œæ‰€ä»¥ <code>@Put(&quot;list/user&quot;)</code>è£…é¥°çš„æ–¹æ³•åº”è¯¥å†™åœ¨å®ƒä¹‹å‰ã€‚</p>
</blockquote>
<h3>å…¨å±€è·¯ç”±å‰ç¼€</h3>
<p>é™¤äº†ä¸Šé¢è¿™äº›è£…é¥°å™¨å¯ä»¥è®¾ç½®è·¯ç”±å¤–ï¼Œ æˆ‘ä»¬è¿˜å¯ä»¥è®¾ç½®å…¨å±€è·¯ç”±å‰ç¼€ï¼Œ æ¯”å¦‚ç»™æ‰€ä»¥è·¯ç”±éƒ½åŠ ä¸Š<code>/api</code>å‰ç¼€ã€‚æ­¤æ—¶éœ€è¦ä¿®æ”¹<code>main.ts</code></p>
<pre><code>async function bootstrap() {
  const app = await NestFactory.create(AppModule);
  app.setGlobalPrefix('api'); // è®¾ç½®å…¨å±€è·¯ç”±å‰ç¼€
  await app.listen(9080);
}
bootstrap();
</code></pre>
<p>æ­¤æ—¶ä¹‹å‰çš„è·¯ç”±ï¼Œéƒ½è¦å˜æ›´ä¸ºï¼š</p>
<pre><code>http://localhost/api/xxxx
</code></pre>
<h2>nest-cli å‘½ä»¤</h2>
<p>å†™ä»£ç ä¹‹å‰é¦–å…ˆä»‹ç»å‡ ä¸ª<code>nest-cli</code>æä¾›çš„å‡ ä¸ªæœ‰ç”¨çš„å‘½ä»¤ï¼š</p>
<pre><code>//è¯­æ³•
nest g [æ–‡ä»¶ç±»å‹] [æ–‡ä»¶å] [æ–‡ä»¶ç›®å½•]
</code></pre>
<p><strong>æ³¨æ„åˆ›å»ºé¡ºåº</strong>ï¼š å…ˆåˆ›å»º<code>Module</code>, å†åˆ›å»º<code>Controller</code>å’Œ<code>Service</code>, è¿™æ ·åˆ›å»ºå‡ºæ¥çš„æ–‡ä»¶åœ¨<code>Module</code>ä¸­è‡ªåŠ¨æ³¨å†Œï¼Œåä¹‹ï¼Œååˆ›å»º Module, <code>Controller</code>å’Œ<code>Service</code>, ä¼šè¢«æ³¨å†Œåˆ°å¤–å±‚çš„<code>app.module.ts</code></p>
<h3>nest-cli åˆ›å»ºæ¨¡å—</h3>
<p>nest g mo posts
åˆ›å»ºä¸€ä¸ª posts æ¨¡å—ï¼Œæ–‡ä»¶ç›®å½•ä¸å†™ï¼Œé»˜è®¤åˆ›å»ºå’Œæ–‡ä»¶åä¸€æ ·çš„<code>posts</code>ç›®å½•ï¼Œåœ¨<code>posts</code>ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª<code>posts.module.ts</code></p>
<pre><code>// src/posts/posts.module.ts
import { Module } from '@nestjs/common';

@Module({})
export class PostsModule {}
</code></pre>
<p>æ‰§è¡Œå®Œå‘½ä»¤åï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å‘ç°åŒæ—¶</p>
<ul>
<li>åœ¨æ ¹æ¨¡å—<code>app.module.ts</code>ä¸­å¼•å…¥<code>PostsModule</code>è¿™ä¸ªæ¨¡å—</li>
<li>ä¹Ÿåœ¨<code>@Model</code>è£…é¥°å™¨çš„<code>inports</code>ä¸­å¼•å…¥äº†<code>PostsModule</code></li>
</ul>
<pre><code>import { Module } from '@nestjs/common';
import { AppController } from './app.controller';
import { AppService } from './app.service';
import { PostsModule } from './posts/posts.module';

@Module({
  controllers: [AppController],
  providers: [AppService],
  imports: [PostsModule],
})
export class AppModule {}
</code></pre>
<h3>nest-cli åˆ›å»ºæ§åˆ¶å™¨</h3>
<blockquote>
<p>nest g co posts</p>
</blockquote>
<p>æ­¤æ—¶åˆ›å»ºäº†ä¸€ä¸ª posts æ§åˆ¶å™¨ï¼Œå‘½åä¸º<code>posts.controller.ts</code>ä»¥åŠä¸€ä¸ªè¯¥æ§åˆ¶å™¨çš„å•å…ƒæµ‹è¯•æ–‡ä»¶.</p>
<pre><code>// src/posts/posts.controller.ts
import { Controller } from '@nestjs/common';

@Controller('posts')
export class PostsController {}
</code></pre>
<p>æ‰§è¡Œå®Œå‘½ä»¤ï¼Œ æ–‡ä»¶<code>posts.module.ts</code>ä¸­ä¼šè‡ªåŠ¨å¼•å…¥<code>PostsController</code>, å¹¶ä¸”åœ¨<code>@Module</code>è£…é¥°å™¨çš„<code>controllers</code>ä¸­æ³¨å…¥ã€‚</p>
<h3>nest-cli åˆ›å»ºæœåŠ¡ç±»</h3>
<blockquote>
<p>nest g service posts</p>
</blockquote>
<pre><code>// src/posts/posts.service.ts
import { Injectable } from '@nestjs/common';

@Injectable()
export class PostsService {}
</code></pre>
<p>åˆ›å»º<code>app.service.ts</code>æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨<code>app.module.ts</code>æ–‡ä»¶ä¸‹ï¼Œ<code>@Module</code>è£…é¥°å™¨çš„<code>providers</code>ä¸­æ³¨å…¥æ³¨å…¥ã€‚</p>
<h2>Nest æ•°æ®åº“</h2>
<h3>TypeORM è¿æ¥æ•°æ®åº“</h3>
<h4>å‰ç½®çŸ¥è¯†</h4>
<p>ä»€ä¹ˆæ˜¯ ORM?
ORM æŠ€æœ¯ï¼ˆ<code>Object-Relational Mapping</code>ï¼‰, æŠŠå…³ç³»æ•°æ®åº“çš„å˜ç»“æ„æ˜ å°„åˆ°å¯¹è±¡ä¸Šã€‚</p>
<p>å®˜æ–¹æä¾›äº†ä¸¤ç§è¿æ¥æ•°æ®åº“çš„æ–¹æ³•ï¼Œ è¿™é‡Œåˆ†åˆ«ä»‹ç»ä¸€ä¸‹ï¼š</p>
<p><strong>æ–¹æ³• 1</strong></p>
<p>é¦–å…ˆåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶<code>.env</code>å’Œ<code>.env.prod</code>ï¼Œåˆ†åˆ«å­˜çš„æ˜¯å¼€å‘ç¯å¢ƒå’Œçº¿ä¸Šç¯å¢ƒä¸åŒçš„ç¯å¢ƒå˜é‡ï¼š
<code>.env.prod</code>ä¸­çš„æ˜¯ä¸Šçº¿è¦ç”¨çš„æ•°æ®åº“ä¿¡æ¯ï¼Œå¦‚æœä½ çš„é¡¹ç›®è¦ä¸Šä¼ åˆ°çº¿ä¸Šç®¡ç†ï¼Œä¸ºäº†å®‰å…¨æ€§è€ƒè™‘ï¼Œå»ºè®®è¿™ä¸ªæ–‡ä»¶æ·»åŠ åˆ°<code>.gitignore</code>ä¸­ã€‚</p>
<p>æ¥ç€åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹<code>config</code>(ä¸<code>src</code>åŒçº§)ï¼Œç„¶åå†åˆ›å»ºä¸€ä¸ª<code>env.ts</code>ç”¨äºæ ¹æ®ä¸åŒç¯å¢ƒè¯»å–ç›¸åº”çš„é…ç½®æ–‡ä»¶ã€‚</p>
<pre><code>import * as fs from 'fs';
import * as path from 'path';
const isProd = process.env.NODE_ENV === 'production';

function parseEnv() {
  const localEnv = path.resolve('.env');
  const prodEnv = path.resolve('.env.prod');

  if (!fs.existsSync(localEnv) &amp;&amp; !fs.existsSync(prodEnv)) {
    throw new Error('ç¼ºå°‘ç¯å¢ƒé…ç½®æ–‡ä»¶');
  }

  const filePath = isProd &amp;&amp; fs.existsSync(prodEnv) ? prodEnv : localEnv;
  return { path:filePath };
}
export default parseEnv();
</code></pre>
<p>ç„¶ååœ¨<code>app.module.ts</code>ä¸­è¿æ¥æ•°æ®åº“ï¼š
<code>@nestjs/config</code>ä¾èµ–äº dotenvï¼Œå¯ä»¥é€šè¿‡ key=value å½¢å¼é…ç½®ç¯å¢ƒå˜é‡ï¼Œé¡¹ç›®ä¼šé»˜è®¤åŠ è½½æ ¹ç›®å½•ä¸‹çš„. env æ–‡ä»¶ï¼Œæˆ‘ä»¬åªéœ€åœ¨ app.module.ts ä¸­å¼•å…¥ ConfigModuleï¼Œä½¿ç”¨ ConfigModule.forRoot() æ–¹æ³•å³å¯ï¼Œç„¶å<code>ConfigService</code>è¯»å–ç›¸å…³çš„é…ç½®å˜é‡ã€‚</p>
<p><code>TypeORM</code>æä¾›äº†å¤šç§è¿æ¥æ–¹å¼ï¼Œè¿™é‡Œå†ä»‹ç»ä¸€ä¸‹ä½¿ç”¨<code>ormconfig.json</code>æ–¹å¼</p>
<p><strong>æ–¹æ³• 2  ormconfig.json</strong></p>
<p>åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª<code>ormconfig.json</code>æ–‡ä»¶ (ä¸<code>src</code>åŒçº§), è€Œä¸æ˜¯å°†é…ç½®å¯¹è±¡ä¼ é€’ç»™<code>forRoot()</code>çš„æ–¹å¼ã€‚</p>
<pre><code>{ 
    &quot;type&quot;: &quot;mysql&quot;,
    &quot;host&quot;: &quot;localhost&quot;, 
    &quot;port&quot;: 3306, 
    &quot;username&quot;: &quot;root&quot;, 
    &quot;password&quot;: &quot;root&quot;, 
    &quot;database&quot;: &quot;blog&quot;, 
    &quot;entities&quot;: [&quot;dist/**/*.entity{.ts,.js}&quot;], 
    &quot;synchronize&quot;: true  // è‡ªåŠ¨è½½å…¥çš„æ¨¡å‹å°†åŒæ­¥
}
</code></pre>
<p>ç„¶ååœ¨<code>app.module.ts</code>ä¸­ä¸å¸¦ä»»ä½•é€‰é¡¹çš„è°ƒç”¨<code>forRoot()</code>, è¿™æ ·å°±å¯ä»¥äº†ï¼Œæƒ³äº†è§£æ›´å¤šè¿æ¥æ•°æ®åº“çš„æ–¹å¼å¯ä»¥å»æœ‰ <a href="https://link.juejin.cn?target=https%3A%2F%2Ftypeorm.bootcss.com%2Fconnection" title="https://typeorm.bootcss.com/connection">TypeORM å®˜ç½‘</a>æŸ¥çœ‹</p>
<pre><code>import { Module } from '@nestjs/common';
import { TypeOrmModule } from '@nestjs/typeorm';

@Module({ 
    imports: [TypeOrmModule.forRoot()],
})
export class AppModule {}
</code></pre>
<h3>æ•°æ®åº“ åˆ›å»ºå®ä½“</h3>
<p>å¥½äº†ï¼Œæ¥ä¸‹æ¥å°±è¿›è¡Œæ•°æ®æ“ä½œï¼Œ
æˆ‘ä»¬é€šè¿‡ä»£ç æ¥å»ºè¡¨ï¼Œ å…ˆå»ºç«‹ä¸€ä¸ªæ–‡ç« å®ä½“<code>PostsEntity</code>, åœ¨<code>posts</code>ç›®å½•ä¸‹åˆ›å»º<code>posts.entity.ts</code></p>
<pre><code>//    posts/posts.entity.ts
import { Column, Entity, PrimaryGeneratedColumn } from &quot;typeorm&quot;;

@Entity(&quot;posts&quot;)
export class PostsEntity {
    @PrimaryGeneratedColumn()
    id:number; // æ ‡è®°ä¸ºä¸»åˆ—ï¼Œå€¼è‡ªåŠ¨ç”Ÿæˆ

    @Column({ length:50 })
    title: string;

    @Column({ length: 20})
    author: string;

    @Column(&quot;text&quot;)
    content:string;

    @Column({default:''})
    thumb_url: string;

    @Column('tinyint')
    type:number

    @Column({type: 'timestamp', default: () =&gt; &quot;CURRENT_TIMESTAMP&quot;})
    create_time: Date

    @Column({type: 'timestamp', default: () =&gt; &quot;CURRENT_TIMESTAMP&quot;})
    update_time: Date
}
</code></pre>
<h3>æ•°æ®åº“CRUD</h3>
<p>æ¥ä¸‹æ¥åœ¨<code>posts.service.ts</code>æ–‡ä»¶ä¸­å®ç°<code>CRUD</code>æ“ä½œçš„ä¸šåŠ¡é€»è¾‘ï¼Œè¿™é‡Œçš„è¡¨å¹¶ä¸æ˜¯æœ€ç»ˆçš„æ–‡ç« è¡¨ï¼Œåªæ˜¯ä¸ºäº†å…ˆå®ç°ä¸€ä¸‹ç®€å•çš„å¢åˆ æ”¹æŸ¥æ¥å£ï¼Œ åé¢è¿˜ä¼šå®ç°å¤æ‚çš„å¤šè¡¨å…³è”ã€‚</p>
<pre><code>import { HttpException, Injectable } from '@nestjs/common';
import { InjectRepository } from '@nestjs/typeorm';
import { getRepository, Repository } from 'typeorm';
import { PostsEntity } from './posts.entity';

export interface PostsRo {
  list: PostsEntity[];
  count: number;
}
@Injectable()
export class PostsService {
  constructor(
    @InjectRepository(PostsEntity)
    private readonly postsRepository: Repository&lt;PostsEntity&gt;,
  ) {}

  // åˆ›å»ºæ–‡ç« 
  async create(post: Partial&lt;PostsEntity&gt;): Promise&lt;PostsEntity&gt; {
    const { title } = post;
    if (!title) {
      throw new HttpException('ç¼ºå°‘æ–‡ç« æ ‡é¢˜', 401);
    }
    const doc = await this.postsRepository.findOne({ where: { title } });
    if (doc) {
      throw new HttpException('æ–‡ç« å·²å­˜åœ¨', 401);
    }
    return await this.postsRepository.save(post);
  }
  
  // è·å–æ–‡ç« åˆ—è¡¨
  async findAll(query): Promise&lt;PostsRo&gt; {
    const qb = await getRepository(PostsEntity).createQueryBuilder('post');
    qb.where('1 = 1');
    qb.orderBy('post.create_time', 'DESC');

    const count = await qb.getCount();
    const { pageNum = 1, pageSize = 10, ...params } = query;
    qb.limit(pageSize);
    qb.offset(pageSize * (pageNum - 1));

    const posts = await qb.getMany();
    return { list: posts, count: count };
  }

  // è·å–æŒ‡å®šæ–‡ç« 
  async findById(id): Promise&lt;PostsEntity&gt; {
    return await this.postsRepository.findOne(id);
  }

  // æ›´æ–°æ–‡ç« 
  async updateById(id, post): Promise&lt;PostsEntity&gt; {
    const existPost = await this.postsRepository.findOne(id);
    if (!existPost) {
      throw new HttpException(`idä¸º${id}çš„æ–‡ç« ä¸å­˜åœ¨`, 401);
    }
    const updatePost = this.postsRepository.merge(existPost, post);
    return this.postsRepository.save(updatePost);
  }

  // åˆªé™¤æ–‡ç« 
  async remove(id) {
    const existPost = await this.postsRepository.findOne(id);
    if (!existPost) {
      throw new HttpException(`idä¸º${id}çš„æ–‡ç« ä¸å­˜åœ¨`, 401);
    }
    return await this.postsRepository.remove(existPost);
  }
}
</code></pre>
<hr>
<p>ä¿å­˜æ–‡ä»¶ï¼Œ æŠ¥é”™ä¿¡æ¯æç¤º<code>PostsEntity</code>æ²¡æœ‰å¯¼å…¥ï¼š</p>
<p><img src="file://Mac/Home/myGitHubMac/simple-read/_resources/1adad989226937df3ab01706de834c20_MD5.webp" /></p>
<p>æ­¤æ—¶åœ¨<code>posts.module.ts</code>ä¸­å°†<code>PostsEntity</code>å¯¼å…¥ï¼š</p>
<pre><code>import { TypeOrmModule } from '@nestjs/typeorm';
@Module({
  imports: [TypeOrmModule.forFeature([PostsEntity])],
  ...
})
</code></pre>
<p>å¦‚æœä½ æ˜¯æŒ‰ç…§æ–‡ç« è¿›è¡Œï¼Œä½¿ç”¨ç¬¬ä¸€ç§æ–¹å¼è¿æ¥æ•°æ®åº“ï¼Œè¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå°å‘<code>æ‰¾ä¸åˆ°PostsEntityå®ä½“</code>ï¼š</p>
<p>æˆ‘ä»¬è¿˜éœ€è¦åœ¨<code>app.module.ts</code>æ·»åŠ ä¸€ä¸‹ï¼š</p>
<p><img src="file://Mac/Home/myGitHubMac/simple-read/_resources/6f88eb8a7b11862b8f4c46d81e70f14e_MD5.webp" /></p>
<h3>æ•°æ®åº“REST é£æ ¼å®ç°</h3>
<p>é‡‡ç”¨ REST é£æ ¼æ¥å®ç°æ¥å£ï¼Œ
åœ¨<code>posts.controller.ts</code>ä¸­è®¾ç½®è·¯ç”±äº†ï¼Œå¤„ç†æ¥å£è¯·æ±‚ï¼Œè°ƒç”¨ç›¸åº”çš„æœåŠ¡å®Œæˆä¸šåŠ¡é€»è¾‘ï¼š</p>
<pre><code>import { PostsService, PostsRo } from './posts.service';
import { Body, Controller, Delete, Get, Param, Post, Put, Query } from '@nestjs/common';

@Controller('post')
export class PostsController {
    constructor(private readonly postsService:PostsService){}

    /**
     * åˆ›å»ºæ–‡ç« 
     * @param post
     */
    @Post()
    async create(@Body() post){
        return await this.postsService.create(post)
    }

    /**
     * è·å–æ‰€æœ‰æ–‡ç« 
     */
    @Get()
    async findAll(@Query() query):Promise&lt;PostsRo&gt;{
        return await this.postsService.findAll(query)
    }

    /**
     * è·å–æŒ‡å®šæ–‡ç« 
     * @param id 
     */
    @Get(':id')
    async findById(@Param('id') id) {
        return await this.postsService.findById(id)
    }

    /**
     * æ›´æ–°æ–‡ç« 
     * @param id 
     * @param post 
     */
    @Put(&quot;:id&quot;)
    async update(@Param(&quot;id&quot;) id, @Body() post){
        return await this.postsService.updateById(id, post)
    }

    /**
     * åˆ é™¤
     * @param id 
     */
    @Delete(&quot;id&quot;)
    async remove(@Param(&quot;id&quot;) id){
        return await this.postsService.remove(id)
    }
}
</code></pre>
<h3>æ“ä½œæ•°æ®åº“è¸©è¿‡çš„å‘</h3>
<ol>
<li>å®ä½“çš„å¼ºæ›¿æ¢ï¼Œè«åå…¶å¦™çš„åˆ è¡¨ï¼Œæ¸…ç©ºæ•°æ® ä»¥æˆ‘ä»¬ä¸Šé¢è®¾ç½®çš„å®ä½“ä¸ºä¾‹ï¼š</li>
</ol>
<pre><code>export class PostsEntity {
    @PrimaryGeneratedColumn()
    id: number;

    @Column()
    title: string;
}
</code></pre>
<p>æœ€å¼€åˆæˆ‘è®¾è®¡è¡¨ä¸­<code>title</code>å­—æ®µæ—¶ï¼Œå­—æ®µç±»å‹ç›´æ¥è®¾ç½®æˆ<code>string</code>, ä¹Ÿå°±å¯¹åº”æ•°æ®åº“ç±»å‹æ˜¯<code>varchar(255)</code>, åæ¥è§‰å¾—ä¸åˆé€‚ï¼Œå¯¹é•¿åº¦è¿›è¡Œäº†é™åˆ¶, æ›´æ”¹ä¸º<code>varchar(50)</code>, ä¹Ÿå°±æ˜¯è¿™æ ·ä¿®æ”¹ä¸€ä¸‹ä»£ç ï¼š</p>
<pre><code>@Column({length: 50})
    title: string;
</code></pre>
<p>ä¿å­˜ä»£ç åï¼Œç»“æœï¼ æˆ‘æ•°æ®åº“ä¸­æ‰€ä»¥çš„<code>title</code>éƒ½è¢«æ¸…ç©ºäº†ï¼Œè¿™ä¸ªå‘çœŸæ˜¯è°è¸©è°çŸ¥é“~</p>
<h3><code>entities</code>çš„ä¸‰ç§è®¾ç½®æ–¹å¼</h3>
<p>å„ç§æ–¹å¼çš„å‘ç‚¹ï¼š</p>
<h3>entities<strong>æ–¹å¼ 1ï¼š å•ç‹¬å®šä¹‰</strong></h3>
<pre><code>TypeOrmModule.forRoot({
  //...
  entities: [PostsEntity, UserEntity],
}),]
</code></pre>
<p>å°±æ˜¯ç”¨åˆ°å“ªäº›å®ä½“ï¼Œ å°±é€ä¸€çš„åœ¨è¿æ¥æ•°æ®åº“æ—¶å»å¯¼å…¥ï¼Œç¼ºç‚¹å°±æ˜¯éº»çƒ¦ï¼Œå¾ˆå®¹æ˜“å¿˜è®°~</p>
<h3><strong>æ–¹å¼ 2ï¼šè‡ªåŠ¨åŠ è½½</strong></h3>
<pre><code>TypeOrmModule.forRoot({
  //...
  autoLoadEntities: true,
}),]
</code></pre>
<p>è‡ªåŠ¨åŠ è½½æˆ‘ä»¬çš„å®ä½“, æ¯ä¸ªé€šè¿‡<code>forFeature()</code>æ³¨å†Œçš„å®ä½“éƒ½ä¼šè‡ªåŠ¨æ·»åŠ åˆ°é…ç½®å¯¹è±¡çš„<code>entities</code>æ•°ç»„ä¸­,Â <code>forFeature()</code>å°±æ˜¯åœ¨æŸä¸ª<code>service</code>ä¸­çš„<code>imports</code>é‡Œé¢å¼•å…¥çš„, è¿™ä¸ªæ˜¯æˆ‘ä¸ªäººæ¯”è¾ƒæ¨èçš„ï¼Œå®é™…å¼€å‘æˆ‘ç”¨çš„ä¹Ÿæ˜¯è¿™ç§æ–¹å¼ã€‚</p>
<h3>æ–¹å¼ 3: é…ç½®è·¯å¾„è‡ªåŠ¨å¼•å…¥</h3>
<pre><code>TypeOrmModule.forRoot({
      //...
      entities: ['dist/**/*.entity{.ts,.js}'],
    }),]
</code></pre>
<p>é€šè¿‡é…ç½®çš„è·¯å¾„ï¼Œ è‡ªåŠ¨å»å¯¼å…¥å®ä½“ã€‚</p>
<p>è¿™ç§æ–¹å¼å°±æ˜¯å‰é¢ä»‹ç»è¿æ¥æ•°æ®åº“ç¬¬äºŒç§æ–¹å¼ä¸­ä½¿ç”¨çš„ï¼Œ But~ è¶…çº§ä¸æ¨èã€‚ç»™ä½ å‘ˆç°ä¸€ä¸‹æˆ‘å½“æ—¶è¸©å¾—å‘ï¼š</p>
<ol>
<li>å½“æ—¶å†™äº†ä¸€ä¸ª<code>Category</code>å®ä½“ï¼Œ ç„¶åæƒ³å¢åŠ ä¸€ä¸ª<code>Tag</code>å®ä½“</li>
<li>å¤åˆ¶äº†<code>category.entity.ts</code>, æ”¾åˆ°<code>tag</code>æ–‡ä»¶å¤¹ä¸‹ï¼Œå¹¶ä¸”æ›´åä¸º<code>tag.entiry.ts</code></li>
<li>ä¿®æ”¹äº†å†…éƒ¨çš„å±æ€§ï¼ˆåˆ çš„åˆ ï¼Œæ”¹çš„æ”¹ï¼‰ï¼Œ å˜æˆäº†ä¸€ä¸ª<code>Tag</code>å®ä½“ï¼Œå¼€å¿ƒçš„ä¿å­˜äº†</li>
<li>ä½†æ˜¯ï¼Œæˆ‘å¿˜è®°äº†ä¿®æ”¹ç±»åï¼Œ æ‰€ä»¥æˆ‘çš„<code>category</code>è¡¨è¢«æ¸…ç©ºäº†ï¼Œ é‡Œé¢æ•°æ®éƒ½æ²¡äº†~</li>
</ol>
<p>å°±ä¸Šé¢è¿™ä¸¤ä¸ªå‘ï¼Œå¦‚æœä½ æ˜¯ç©ºæ•°æ®åº“ï¼Œ ä½ éšä¾¿æŠ˜è…¾ï¼Œ ä½†æ˜¯ä½ æ•°æ®åº“ä¸­æœ‰æ•°æ®çš„ç«¥é‹ï¼Œ å»ºè®®ä¸€å®šè¦è°¨æ…ç‚¹ï¼Œ è¿æ¥æ•°æ®åº“æ—¶ï¼Œ ä¸Šæ¥å…ˆæŠŠ<code>synchronize:false</code>è®¾ç½®ä¸Šï¼Œ ä¿å‘½è¦ç´§</p>
<h2>æ¥å£æ ¼å¼ç»Ÿä¸€</h2>
<blockquote>
<p>ä¸€èˆ¬å¼€å‘ä¸­æ˜¯ä¸ä¼šæ ¹æ®<code>HTTP</code>çŠ¶æ€ç æ¥åˆ¤æ–­æ¥å£æˆåŠŸä¸å¤±è´¥çš„ï¼Œ è€Œæ˜¯ä¼šæ ¹æ®è¯·æ±‚è¿”å›çš„æ•°æ®ï¼Œé‡Œé¢åŠ ä¸Š<code>code</code>å­—æ®µ</p>
</blockquote>
<p>é¦–å…ˆå®šä¹‰è¿”å›çš„ json æ ¼å¼ï¼š</p>
<pre><code>{
    &quot;code&quot;: 0,
    &quot;message&quot;: &quot;OK&quot;,
    &quot;data&quot;: {
    }
}
</code></pre>
<p>è¯·æ±‚å¤±è´¥æ—¶è¿”å›ï¼š</p>
<pre><code>{
    &quot;code&quot;: -1,
    &quot;message&quot;: &quot;error reason&quot;,
    &quot;data&quot;: {}
}
</code></pre>
<h3>æ‹¦æˆªé”™è¯¯è¯·æ±‚</h3>
<p>ç›®æ ‡å¯¹è¯·æ±‚é”™è¯¯å°±å¯ä»¥ç»Ÿä¸€çš„è¿”å›äº†ï¼Œè¿”å›è¯·æ±‚é”™è¯¯åªéœ€è¦æŠ›å‡ºå¼‚å¸¸å³å¯, æ¯”å¦‚ä¹‹å‰çš„ï¼š</p>
<pre><code>throw new HttpException('æ–‡ç« å·²å­˜åœ¨', 401);
</code></pre>
<p>å¯ä»¥ç”¨è¿‡æ»¤å™¨æ¥è§£å†³ã€‚</p>
<hr>
<p>ä½¿ç”¨å‘½ä»¤åˆ›å»ºä¸€ä¸ªè¿‡æ»¤å™¨ï¼š</p>
<pre><code>nest g filter core/filter/http-exception
</code></pre>
<p>è¿‡æ»¤å™¨ä»£ç å®ç°ï¼š</p>
<pre><code class="language-js">import {ArgumentsHost,Catch, ExceptionFilter, HttpException} from '@nestjs/common';

@Catch(HttpException)
export class HttpExceptionFilter implements ExceptionFilter {
  catch(exception: HttpException, host: ArgumentsHost) {
    const ctx = host.switchToHttp(); // è·å–è¯·æ±‚ä¸Šä¸‹æ–‡
    const response = ctx.getResponse(); // è·å–è¯·æ±‚ä¸Šä¸‹æ–‡ä¸­çš„ responseå¯¹è±¡
    const status = exception.getStatus(); // è·å–å¼‚å¸¸çŠ¶æ€ç 

    // è®¾ç½®é”™è¯¯ä¿¡æ¯
    const message = exception.message
      ? exception.message
      : `${status &gt;= 500 ? 'Service Error' : 'Client Error'}`;
    const errorResponse = {
      data: {},
      message: message,
      code: -1,
    };

    // è®¾ç½®è¿”å›çš„çŠ¶æ€ç ï¼Œ è¯·æ±‚å¤´ï¼Œå‘é€é”™è¯¯ä¿¡æ¯
    response.status(status);
    response.header('Content-Type', 'application/json; charset=utf-8');
    response.send(errorResponse);
  }
}
</code></pre>
<p>æœ€åéœ€è¦åœ¨<code>main.ts</code>ä¸­å…¨å±€æ³¨å†Œ</p>
<pre><code>...
import { TransformInterceptor } from './core/interceptor/transform.interceptor';

async function bootstrap() {
  const app = await NestFactory.create&lt;NestExpressApplication&gt;(AppModule);
  ...
   // æ³¨å†Œå…¨å±€é”™è¯¯çš„è¿‡æ»¤å™¨
  app.useGlobalInterceptors(new TransformInterceptor());
  await app.listen(9080);
}
bootstrap();
</code></pre>
<h3>æ‹¦æˆªæˆåŠŸçš„è¿”å›æ•°æ®</h3>
<p>å¯¹è¯·æ±‚æˆåŠŸè¿”å›çš„æ ¼å¼è¿›è¡Œç»Ÿä¸€çš„å¤„ç†ï¼Œå¯ä»¥ç”¨<code>Nest.js</code>çš„æ‹¦æˆªå™¨æ¥å®ç°ã€‚</p>
<p>é¦–å…ˆä½¿ç”¨å‘½ä»¤åˆ›å»ºä¸€ä¸ªæ‹¦æˆªå™¨ï¼š</p>
<pre><code>nest g interceptor core/interceptor/transform
</code></pre>
<p>æ‹¦æˆªå™¨ä»£ç å®ç°ï¼š</p>
<pre><code>import {CallHandler, ExecutionContext, Injectable,NestInterceptor,} from '@nestjs/common';
import { map, Observable } from 'rxjs';

@Injectable()
export class TransformInterceptor implements NestInterceptor {
  intercept(context: ExecutionContext, next: CallHandler): Observable&lt;any&gt; {
    return next.handle().pipe(
      map((data) =&gt; {
        return {
          data,
          code: 0,
          msg: 'è¯·æ±‚æˆåŠŸ',
        };
      }),
    );
  }
}
</code></pre>
<p>æœ€åå’Œè¿‡æ»¤å™¨ä¸€æ ·ï¼Œåœ¨<code>main.ts</code>ä¸­å…¨å±€æ³¨å†Œï¼š</p>
<pre><code>...
import { TransformInterceptor } from './core/interceptor/transform.interceptor';

async function bootstrap() {
  const app = await NestFactory.create&lt;NestExpressApplication&gt;(AppModule);
  ...
  // å…¨å±€æ³¨å†Œæ‹¦æˆªå™¨
 app.useGlobalInterceptors(new TransformInterceptor())
  await app.listen(9080);
}
bootstrap();
</code></pre>
<p>è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨å®ç°éƒ½æ˜¯ä¸‰éƒ¨æ›²ï¼š<code>åˆ›å»º &gt; å®ç° &gt; æ³¨å†Œ</code>ï¼Œè¿˜æ˜¯å¾ˆç®€å•çš„ã€‚
ç°åœ¨æˆ‘ä»¬å†è¯•è¯•æ¥å£ï¼Œçœ‹çœ‹è¿”å›çš„æ•°æ®æ ¼å¼æ˜¯ä¸æ˜¯è§„èŒƒäº†?</p>
<h2>é…ç½®æ¥å£æ–‡æ¡£ Swagger</h2>
<p>è¿™é‡Œç”¨<code>swagger</code>ï¼Œå†™æ¥å£æ–‡æ¡£<code>Nest.js</code>æä¾›äº†ä¸“ç”¨çš„æ¨¡å—æ¥ä½¿ç”¨å®ƒ</p>
<p>å®‰è£…ååœ¨<code>main.ts</code>ä¸­è®¾ç½®<code>Swagger</code>æ–‡æ¡£ä¿¡æ¯ï¼š</p>
<pre><code class="language-js">...
import { SwaggerModule, DocumentBuilder } from '@nestjs/swagger';

async function bootstrap() {
  const app = await NestFactory.create&lt;NestExpressApplication&gt;(AppModule);
  ...
  // è®¾ç½®swaggeræ–‡æ¡£
  const config = new DocumentBuilder()
    .setTitle('ç®¡ç†åå°')   
    .setDescription('ç®¡ç†åå°æ¥å£æ–‡æ¡£')
    .setVersion('1.0')
    .addBearerAuth()
    .build();
  const document = SwaggerModule.createDocument(app, config);
  SwaggerModule.setup('docs', app, document);

  await app.listen(9080);
}
bootstrap();
</code></pre>
<p>é…ç½®å®Œæˆï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¿é—®ï¼š<code>http://localhost:9080/docs</code>, æ­¤æ—¶å°±èƒ½çœ‹åˆ°<code>Swagger</code>ç”Ÿæˆçš„æ–‡æ¡£ï¼š</p>
<p><img src="file://Mac/Home/myGitHubMac/simple-read/_resources/4add4a76c67d702c758a6637de1a465a_MD5.webp" /></p>
<h3>æ¥å£æ ‡ç­¾</h3>
<p>æˆ‘ä»¬å¯ä»¥æ ¹æ®<code>Controller</code>æ¥åˆ†ç±»ï¼Œ åªè¦æ·»åŠ <code>@ApiTags</code>å°±å¯ä»¥</p>
<pre><code>...
import { ApiTags } from '@nestjs/swagger';
import { Body, Controller, Delete, Get, Param, Post, Put, Query } from '@nestjs/common';

@ApiTags(&quot;æ–‡ç« &quot;)
@Controller('post')
export class PostsController {...}
</code></pre>
<p>å¯¹<code>posts.controller.ts</code>å’Œ<code>app.controller.ts</code> éƒ½åˆ†åˆ«åŠ ä¸Šåˆ†ç±»æ ‡ç­¾ï¼Œåˆ·æ–°<code>Swagger</code>æ–‡æ¡£ï¼Œçœ‹åˆ°çš„æ•ˆæœæ˜¯è¿™æ ·çš„ï¼š</p>
<p><img src="file://Mac/Home/myGitHubMac/simple-read/_resources/129f4dedb23abd5b4f00bf86be5124f6_MD5.webp" /></p>
<h3>æ¥å£è¯´æ˜</h3>
<p>è¿›ä¸€æ­¥ä¼˜åŒ–æ–‡æ¡£ï¼Œ ç»™æ¯ä¸€ä¸ªæ¥å£æ·»åŠ è¯´æ˜æ–‡å­—
åŒæ ·åœ¨<code>Controller</code>ä¸­ï¼Œ åœ¨æ¯ä¸€ä¸ªè·¯ç”±çš„å‰é¢ä½¿ç”¨<code>@ApiOperation</code>è£…é¥°å™¨ï¼š</p>
<pre><code>//  posts.controller.ts
...
import { ApiTags,ApiOperation } from '@nestjs/swagger';
export class PostsController {

  @ApiOperation({ summary: 'åˆ›å»ºæ–‡ç« ' })
  @Post()
  async create(@Body() post) {....}
  
  @ApiOperation({ summary: 'è·å–æ–‡ç« åˆ—è¡¨' })
  @Get()
  async findAll(@Query() query): Promise&lt;PostsRo&gt; {...}
  ....
}
</code></pre>
<p>ç°åœ¨æˆ‘ä»¬å¯¹æ¯ä¸€ä¸ªæ¥å£éƒ½å†™ä¸Šäº†è¯´æ˜ï¼Œå†æ¥çœ‹çœ‹æ¥å£æ–‡æ¡£å±•ç°ï¼š <img src="file://Mac/Home/myGitHubMac/simple-read/_resources/41fc78331409bdf3bf08f80bcaba09a7_MD5.webp" /></p>
<h3>æ¥å£ä¼ å‚</h3>
<p>æœ€åæˆ‘ä»¬è¦å¤„ç†çš„å°±æ˜¯æ¥å£å‚æ•°è¯´æ˜ï¼Œ
<code>Swagger</code>çš„ä¼˜åŠ¿ä¹‹ä¸€å°±æ˜¯ï¼Œåªè¦æ³¨è§£åˆ°ä½ï¼Œå¯ä»¥ç²¾ç¡®å±•ç¤ºæ¯ä¸ªå­—æ®µçš„æ„ä¹‰</p>
<hr>
<p>è¿™é‡Œéœ€è¦å…ˆæ’å…¥ä¸€æ®µå…³äº<code>DTO</code>çš„è§£é‡Š, å› ä¸ºåé¢å‚æ•°è¯´æ˜ä¼šç”¨åˆ°ï¼š</p>
<blockquote>
<p>æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆDTO)(Data Transfer Object)ï¼Œæ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ä¹‹é—´ä¼ è¾“æ•°æ®çš„è½¯ä»¶åº”ç”¨ç³»ç»Ÿã€‚æ•°æ®ä¼ è¾“ç›®æ ‡å¾€å¾€æ˜¯æ•°æ®è®¿é—®å¯¹è±¡ä»æ•°æ®åº“ä¸­æ£€ç´¢æ•°æ®ã€‚æ•°æ®ä¼ è¾“å¯¹è±¡ä¸æ•°æ®äº¤äº’å¯¹è±¡æˆ–æ•°æ®è®¿é—®å¯¹è±¡ä¹‹é—´çš„å·®å¼‚æ˜¯ä¸€ä¸ªä»¥ä¸å…·æœ‰ä»»ä½•è¡Œä¸ºé™¤äº†å­˜å‚¨å’Œæ£€ç´¢çš„æ•°æ®ï¼ˆè®¿é—®å’Œå­˜å–å™¨ï¼‰ã€‚</p>
</blockquote>
<p>è¿™ä¸€æ®µæ˜¯å®˜æ–¹è§£é‡Šï¼Œ çœ‹ä¸æ‡‚æ²¡å…³ç³»ï¼Œå¯ä»¥ç†è§£æˆï¼Œ<code>DTO æœ¬èº«æ›´åƒæ˜¯ä¸€ä¸ªæŒ‡å—</code>,
åœ¨ä½¿ç”¨ API æ—¶ï¼Œæ–¹ä¾¿æˆ‘ä»¬äº†è§£<code>è¯·æ±‚æœŸæœ›çš„æ•°æ®ç±»å‹</code>ä»¥åŠ<code>è¿”å›çš„æ•°æ®å¯¹è±¡</code>ã€‚å…ˆä½¿ç”¨ä¸€ä¸‹ï¼Œå¯èƒ½æ›´æ–¹ä¾¿ç†è§£ã€‚</p>
<hr>
<p>åœ¨<code>posts</code>ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª<code>dto</code>æ–‡ä»¶å¤¹ï¼Œå†åˆ›å»ºä¸€ä¸ª<code>create-post.dot.ts</code>æ–‡ä»¶ï¼š</p>
<pre><code>// dto/create-post.dot.ts
export class CreatePostDto {
  readonly title: string;
  readonly author: string;
  readonly content: string;
  readonly cover_url: string;
  readonly type: number;
}
</code></pre>
<p>ç„¶ååœ¨<code>Controller</code>ä¸­å¯¹åˆ›å»ºæ–‡ç« æ˜¯ä¼ å…¥çš„å‚æ•°è¿›è¡Œç±»å‹è¯´æ˜ï¼š</p>
<pre><code>//  posts.controller.ts
...
import { CreatePostDto } from './dto/create-post.dto';

@ApiOperation({ summary: 'åˆ›å»ºæ–‡ç« ' })
@Post()
async create(@Body() post:CreatePostDto) {...}
</code></pre>
<p>è¿™é‡Œæå‡ºä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>ä¸ºä»€ä¹ˆä¸ä½¿ç”¨ <code>interface</code> è€Œè¦ä½¿ç”¨ <code>class</code> æ¥å£°æ˜ <code>CreatePostDto</code></li>
<li>ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨ä¹‹å‰å®šä¹‰çš„å®ä½“ç±»å‹<code>PostsEntiry</code>ï¼Œè€Œæ˜¯åˆå®šä¹‰ä¸€ä¸ª <code>CreatePostDto</code></li>
</ol>
<h3>ä¸ºä»€ä¹ˆä¸ä½¿ç”¨ <code>interface</code> è€Œè¦ä½¿ç”¨ <code>class</code> æ¥å£°æ˜ <code>CreatePostDto</code></h3>
<p>å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“<code>Typescript</code>æ¥å£åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­æ˜¯è¢«åˆ é™¤çš„ï¼Œå…¶æ¬¡åé¢æˆ‘ä»¬è¦ç»™å‚æ•°åŠ è¯´æ˜, ä½¿ç”¨<code>Swagger</code>çš„è£…é¥°å™¨ï¼Œ<code>interface</code>ä¹Ÿæ˜¯æ— æ³•å®ç°çš„ï¼Œæ¯”å¦‚ï¼š</p>
<pre><code>import { ApiProperty } from '@nestjs/swagger';

export class CreatePostDto {
  @ApiProperty({ description: 'æ–‡ç« æ ‡é¢˜' })
  readonly title: string;

  @ApiProperty({ description: 'ä½œè€…' })
  readonly author: string;

  @ApiPropertyOptional({ description: 'å†…å®¹' })
  readonly content: string;

  @ApiPropertyOptional({ description: 'æ–‡ç« å°é¢' })
  readonly cover_url: string;

  @ApiProperty({ description: 'æ–‡ç« ç±»å‹' })
  readonly type: number;
}
</code></pre>
<p><code>@ApiPropertyOptional</code>è£…é¥°å¯é€‰å‚æ•°ï¼Œç»§ç»­çœ‹å¼€ä¸€ä¸‹ API æ–‡æ¡£çš„ UIï¼š</p>
<p><img src="file://Mac/Home/myGitHubMac/simple-read/_resources/1818494ce5b47994a1209a032bb08432_MD5.webp" /></p>
<h3>ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨å®ä½“ç±»å‹<code>PostsEntiry</code>ï¼Œè€Œæ˜¯åˆå®šä¹‰ä¸€ä¸ª <code>CreatePostDto</code></h3>
<p>ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨å®ä½“ç±»å‹<code>PostsEntiry</code>ï¼Œè€Œæ˜¯åˆå®šä¹‰ä¸€ä¸ª <code>CreatePostDto</code>ï¼Œå› ä¸º HTTP è¯·æ±‚ä¼ å‚å’Œè¿”å›çš„å†…å®¹å¯ä»¥é‡‡ç”¨å’Œæ•°æ®åº“ä¸­ä¿å­˜çš„å†…å®¹ä¸åŒçš„æ ¼å¼ï¼Œæ‰€ä»¥å°†å®ƒä»¬åˆ†å¼€å¯ä»¥éšç€æ—¶é—´çš„æ¨ç§»åŠä¸šåŠ¡å˜æ›´å¸¦æ¥æ›´å¤§çš„çµæ´»æ€§ï¼Œè¿™é‡Œæ¶‰åŠåˆ°å•ä¸€è®¾è®¡çš„åŸåˆ™ï¼Œå› ä¸ºæ¯ä¸€ä¸ªç±»åº”è¯¥å¤„ç†ä¸€ä»¶äº‹ï¼Œæœ€å¥½åªå¤„ç†ä¸€ä»¶äº‹ã€‚</p>
<p>ç°åœ¨å°±å¯ä»¥ä» API æ–‡æ¡£ä¸Šç›´è§‚çš„çœ‹åˆ°æ¯ä¸ªä¼ å‚çš„å«ä¹‰ã€ç±»å‹ä»¥åŠæ˜¯å¦å¿…ä¼ ã€‚åˆ°è¿™ä¸€æ­¥å¹¶æ²¡æœ‰å®Œï¼Œ è™½ç„¶ä»¥åŠå‘Šè¯‰åˆ«äººæ€ä¹ˆä¼ ï¼Œ ä½†æ˜¯ä¸€ä¸å°å¿ƒä¼ é”™äº†å‘¢ï¼Œ æ¯”å¦‚ä¸Šé¢ä½œè€…å­—æ®µæ²¡ä¼ ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p><img src="file://Mac/Home/myGitHubMac/simple-read/_resources/1ceda566625ad2568094b6952c318ef7_MD5.webp" /></p>
<p>æ¥å£ç›´æ¥æŠ¥ 500 äº†ï¼Œ å› ä¸ºæˆ‘ä»¬å®ä½“å®šä¹‰çš„<code>author</code>å­—æ®µä¸èƒ½ä¸ºç©ºçš„ï¼Œæ‰€æœ‰åœ¨å†™å…¥æ•°æ®æ—¶æŠ¥é”™äº†ã€‚è¿™æ ·ä½“éªŒéå¸¸ä¸å¥½ï¼Œ å¾ˆå¯èƒ½å‰ç«¯å°±æ€€ç–‘æˆ‘ä»¬æ¥å£å†™é”™äº†ï¼Œæ‰€æœ‰æˆ‘ä»¬åº”è¯¥å¯¹å¼‚å¸¸è¿›è¡Œä¸€å®šçš„å¤„ç†ã€‚</p>
<h2>æ•°æ®éªŒè¯</h2>
<p>æ€ä¹ˆå®ç°å‘¢ï¼Ÿé¦–å…ˆæƒ³åˆ°çš„æ˜¯åœ¨ä¸šåŠ¡ä¸­å»å†™ä¸€å †çš„<code>if-elese</code>åˆ¤æ–­ç”¨æˆ·çš„ä¼ å‚ï¼Œä¸€æƒ³åˆ°ä¸€å †çš„åˆ¤æ–­ï¼Œ è¿™ç»å¯¹ä¸æ˜¯æ˜æ™ºä¹‹ä¸¾ï¼Œ</p>
<p>æ‰€æœ‰æˆ‘å»æŸ¥äº†<code>Nest.js</code>ä¸­æ•°æ®éªŒè¯ï¼Œå‘ç°<code>Nest.js</code>ä¸­çš„<strong>ç®¡é“</strong>å°±æ˜¯ä¸“é—¨ç”¨æ¥åšæ•°æ®è½¬æ¢çš„ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹å®ƒçš„å®šä¹‰ï¼š</p>
<h3>ç®¡é“</h3>
<blockquote>
<p>ç®¡é“æ˜¯å…·æœ‰Â <code>@Injectable()</code>Â è£…é¥°å™¨çš„ç±»ã€‚ç®¡é“åº”å®ç°Â <code>PipeTransform</code>Â æ¥å£ã€‚</p>
<p>ç®¡é“æœ‰ä¸¤ä¸ªç±»å‹:</p>
<ul>
<li><strong>è½¬æ¢</strong>ï¼šç®¡é“å°†è¾“å…¥æ•°æ®è½¬æ¢ä¸ºæ‰€éœ€çš„æ•°æ®è¾“å‡º</li>
<li><strong>éªŒè¯</strong>ï¼šå¯¹è¾“å…¥æ•°æ®è¿›è¡ŒéªŒè¯ï¼Œå¦‚æœéªŒè¯æˆåŠŸç»§ç»­ä¼ é€’; éªŒè¯å¤±è´¥åˆ™æŠ›å‡ºå¼‚å¸¸;</li>
</ul>
</blockquote>
<p><img src="file://Mac/Home/myGitHubMac/simple-read/_resources/8f025618d32de1121c9c95e16fe86de5_MD5.webp" /></p>
<h3>ç®¡é“å¼‚å¸¸å¤„ç†</h3>
<p>ç®¡é“åœ¨å¼‚å¸¸åŒºåŸŸå†…è¿è¡Œã€‚è¿™æ„å‘³ç€å½“æŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œå®ƒä»¬ç”±æ ¸å¿ƒå¼‚å¸¸å¤„ç†ç¨‹åºå’Œåº”ç”¨äºå½“å‰ä¸Šä¸‹æ–‡çš„Â <a href="https://link.juejin.cn?target=https%3A%2F%2Fdocs.nestjs.cn%2F8%2Fexceptionfilters" title="https://docs.nestjs.cn/8/exceptionfilters">å¼‚å¸¸è¿‡æ»¤å™¨</a>Â å¤„ç†ã€‚å½“åœ¨ Pipe ä¸­å‘ç”Ÿå¼‚å¸¸ï¼Œcontroller ä¸ä¼šç»§ç»­æ‰§è¡Œä»»ä½•æ–¹æ³•ã€‚</p>
<p>ä»€ä¹ˆæ„æ€å‘¢ï¼Œ é€šä¿—æ¥è®²å°±æ˜¯ï¼Œå¯¹è¯·æ±‚æ¥å£çš„å…¥å‚è¿›è¡ŒéªŒè¯å’Œè½¬æ¢çš„å‰ç½®æ“ä½œï¼ŒéªŒè¯å¥½äº†æˆ‘æ‰ä¼šå°†å†…å®¹ç»™åˆ°è·¯ç”±å¯¹åº”çš„æ–¹æ³•ä¸­å»ï¼Œå¤±è´¥äº†å°±è¿›å…¥å¼‚å¸¸è¿‡æ»¤å™¨ä¸­ã€‚</p>
<h3>Nestè‡ªå¸¦ç®¡é“</h3>
<p><code>Nest.js</code>è‡ªå¸¦äº†ä¸‰ä¸ªå¼€ç®±å³ç”¨çš„ç®¡é“ï¼š<code>ValidationPipe</code>ã€<code>ParseIntPipe</code>å’Œ<code>ParseUUIDPipe</code>, å…¶ä¸­<code>ValidationPipe</code> é…åˆ<code>class-validator</code>å°±å¯ä»¥å®Œç¾çš„å®ç°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœï¼ˆå¯¹å‚æ•°ç±»å‹è¿›è¡ŒéªŒè¯ï¼ŒéªŒè¯å¤±è´¥æŠ›å‡ºå¼‚å¸¸ï¼‰ã€‚</p>
<h3>ç®¡é“éªŒè¯æ“ä½œå®ä¾‹</h3>
<p>ç®¡é“éªŒè¯æ“ä½œé€šå¸¸ç”¨åœ¨<code>dto</code>è¿™ç§ä¼ è¾“å±‚çš„æ–‡ä»¶ä¸­, ç”¨ä½œéªŒè¯æ“ä½œã€‚
é¦–å…ˆæˆ‘ä»¬å®‰è£…ä¸¤ä¸ªéœ€è¦çš„ä¾èµ–åŒ…ï¼š<code>class-transformer</code>å’Œ<code>class-validator</code>
ç„¶ååœ¨<code>create-post.dto.ts</code>æ–‡ä»¶ä¸­æ·»åŠ éªŒè¯, å®Œå–„é”™è¯¯ä¿¡æ¯æç¤ºï¼š</p>
<pre><code>import { IsNotEmpty, IsNumber, IsString } from 'class-validator';

export class CreatePostDto {
  @ApiProperty({ description: 'æ–‡ç« æ ‡é¢˜' })
  @IsNotEmpty({ message: 'æ–‡ç« æ ‡é¢˜å¿…å¡«' })
  readonly title: string;

  @IsNotEmpty({ message: 'ç¼ºå°‘ä½œè€…ä¿¡æ¯' })
  @ApiProperty({ description: 'ä½œè€…' })
  readonly author: string;

  @ApiPropertyOptional({ description: 'å†…å®¹' })
  readonly content: string;

  @ApiPropertyOptional({ description: 'æ–‡ç« å°é¢' })
  readonly cover_url: string;

  @IsNumber()
  @ApiProperty({ description: 'æ–‡ç« ç±»å‹' })
  readonly type: number;
}
</code></pre>
<p><code>class-validator</code>è¿˜æä¾›äº†å¾ˆå¤šçš„éªŒè¯æ–¹æ³•ï¼Œ å¤§å®¶æ„Ÿå…´è¶£å¯ä»¥è‡ªå·±çœ‹<a href="https://link.juejin.cn?target=https%3A%2F%2Fgithub.com%2Ftypestack%2Fclass-validator%23validation-messages" title="https://github.com/typestack/class-validator#validation-messages">å®˜æ–¹æ–‡æ¡£</a>.
æœ€åæˆ‘ä»¬è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„æ­¥éª¤ï¼Œ å°±æ˜¯åœ¨<code>main.ts</code>ä¸­å…¨å±€æ³¨å†Œä¸€ä¸‹ç®¡é“<code>ValidationPipe</code>ï¼š</p>
<pre><code>app.useGlobalPipes(new ValidationPipe());
</code></pre>
<p>æ­¤æ—¶æˆ‘ä»¬åœ¨å‘é€ä¸€ä¸ªåˆ›å»ºæ–‡ç« è¯·æ±‚ï¼Œä¸å¸¦<code>author</code>å‚æ•°ï¼Œ è¿”å›æ•°æ®æœ‰å¾ˆæ¸…æ™°äº†ï¼š
<img src="file://Mac/Home/myGitHubMac/simple-read/_resources/596f2e64050c59200ca5cc8b9fb2e003_MD5.webp" /></p>
<p>é€šè¿‡ä¸Šè¾¹çš„å­¦ä¹ ï¼Œå¯ä»¥çŸ¥é“<code>DTO</code>æœ¬èº«æ˜¯ä¸å­˜åœ¨ä»»ä½•éªŒè¯åŠŸèƒ½ï¼Œ ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å€ŸåŠ©<code>class-validator</code>æ¥è®©<code>DTO</code>å¯ä»¥éªŒè¯æ•°æ®</p>

<h1>é˜…è¯»ç†è§£ä¸è®°å¿†ç³»ç»Ÿ</h1><blockquote>
<p>æœ¬æ–‡ç”± <a href="http://ksria.com/simpread/">ç®€æ‚¦ SimpRead</a> è½¬ç ï¼Œ åŸæ–‡åœ°å€ <a href="https://zhuanlan.zhihu.com/p/653174197">zhuanlan.zhihu.com</a></p>
</blockquote>
<blockquote>
<p><a href="https://zhuanlan.zhihu.com/p/653018968">è·³å‡ºçŸ¥è¯†æœ¬èº«ï¼Œæ£€æŸ¥è‡ªå·±çš„ã€Œé˜…è¯»ç†è§£ã€â€”â€” ç†è§£è¿‡ç¨‹çš„ä¸€ç§è§£é‡Šå’Œå·¥å…·</a>â€”â€”è¯‘è€…è¯„è®º</p>
</blockquote>
<p>å¯¹äºå¤§æ®µå¤§æ®µçš„æ–‡æœ¬ï¼Œäººä»¬ä¸€å¼€å§‹å°±æ²¡ææ¸…æ¥šå®ƒä»¬åˆ°åº•è¡¨è¾¾äº†ä»€ä¹ˆæ„æ€ã€‚</p>
<p>è¯»è€…çš„ç›®å…‰å°±åƒæ‰“æ°´æ¼‚çš„çŸ³å­ä¸€æ ·æ è¿‡ä¹¦é¡µã€‚</p>
<ul>
<li>ä»–ä»¬å¯¹æ–‡æœ¬çš„å¤„ç†æœ€å¤šåªåˆ°è§†è§‰è§£ç å±‚é¢ï¼Œæ–‡ä¸­çš„æ¦‚å¿µç”šè‡³ä»æœªè¿›å…¥å·¥ä½œè®°å¿†ã€‚</li>
<li>è¯šç„¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¹‹å½’å’äºã€Œé˜…è¯»æŠ€èƒ½å¾ˆå·®ã€ï¼Œä½†æˆ‘æ€€ç–‘è®¸å¤šé«˜è–ªçš„çŸ¥è¯†å·¥ä½œè€…ä¹Ÿç»å¸¸ä¼šåƒè¿™æ ·ï¼Œåœ¨æœ€ç®€å•çš„é˜…è¯»ç†è§£ä¸Šå‡ºé”™ã€‚</li>
</ul>
<p>åœ¨å¤§å¤šæ•°è¯¾ç¨‹ä¸­ï¼Œè®²å¸ˆçš„æé—®ä¼šè®©æˆ‘æ„è¯†åˆ°ï¼Œæˆ‘å…¶å®å¹¶æ²¡æœ‰ç†è§£æŸä¸ªé‡è¦æ®µè½çš„æ–‡æœ¬æ‰€è¡¨è¾¾çš„å†…å®¹ â€”â€” è€Œä¸”æˆ‘è‡ªå·±éƒ½æ²¡æœ‰æ³¨æ„åˆ°ã€‚</p>
<h2><strong>é¢†ä¼šä¸»æ—¨</strong></h2>
<p>å¯Ÿè§‰è‡ªå·±æ˜¯å¦ç†è§£çš„æ„è¯†ï¼ˆcomprehension awarenessï¼‰ï¼Œæ˜¯å¦åªæºäºæœ‰è¾ƒé«˜çš„ã€Œè¯­è¨€ç†è§£å’Œè¡¨è¾¾èƒ½åŠ›ã€ï¼ˆSAT verbalï¼Œverbal abilityï¼‰ï¼Ÿ</p>
<ul>
<li>å¹¶ä¸æ˜¯å¦‚æ­¤é«˜ç†è§£çš„åŒå­¦åœ¨ç­”é”™çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šæ›´å¯èƒ½æ„è¯†åˆ°è‡ªå·±é”™äº†</li>
</ul>
<hr>
<p>ä»–ä»¬åšäº†å¦ä¸€ä¸ªå®éªŒï¼Œå’Œä¸Šæ–‡ä»‹ç»çš„å®éªŒç±»ä¼¼ï¼Œä¹Ÿæ˜¯è¦æ±‚ä¸€ç»„å­¦ç”Ÿé˜…è¯»æ¯ç¯‡æ–‡ç« å¹¶å›ç­”é—®é¢˜ã€‚ä¸åŒçš„æ˜¯ï¼Œ</p>
<ul>
<li>è¿™ä¸€æ¬¡ï¼Œä¸ºäº†å¯ä»¥è‡ªä¿¡åœ°å›ç­”é—®é¢˜ï¼Œåªè¦å­¦ç”Ÿè§‰å¾—æœ‰å¿…è¦ï¼Œå¯ä»¥ä¸é™é˜…è¯»æ¬¡æ•°ã€‚å¯¹ç…§ç»„åˆ™æ˜¯åªèƒ½è¯»ä¸€æ¬¡æ–‡ç« ã€‚
ç»“æœï¼Œã€Œé«˜ç¡®å®šåº¦ã€çš„å®éªŒç»„è™½ç„¶åœ¨æ¯ç¯‡æ–‡ç« ä¸ŠèŠ±äº†æ›´å¤šçš„æ—¶é—´ï¼Œä¸”æ‹¥æœ‰æ›´å¤šçš„è‡ªä¿¡ï¼Œä½†å†ç†è§£ä¸Šå¹¶æ²¡æœ‰æ˜¾è‘—åœ°è¡¨ç°å¾—æ›´å¥½ã€‚</li>
</ul>
<h2><strong>ä»ã€Œå®ƒè¯´äº†ä»€ä¹ˆã€åˆ°ã€Œå®ƒæ„å‘³ç€ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿã€</strong></h2>
<p>Dwarkesh å¯¹æˆ‘å­¦ä¹ è¿™æœ¬ä¹¦çš„æ–¹æ³•éå¸¸æƒŠè®¶ã€‚æˆ‘é˜…è¯»ä¸€é¡µè¦ç”¨å¤§çº¦ 15 åˆ†é’Ÿï¼Œè€Œä»–åªç”¨å‡ åˆ†é’Ÿæˆ–è€…æ›´å°‘ã€‚</p>
<p>æ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘ä¸æ–­åœ°å‘æ–‡æœ¬å’Œè‡ªå·±æå‡ºé—®é¢˜ã€‚ä¾‹å¦‚ï¼š</p>
<ul>
<li>è¿™å¥è¯æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæˆ‘èƒ½ç”¨è‡ªå·±çš„è¯è§£é‡Šå®ƒå—ï¼Ÿ-explain by u word</li>
<li>åœ¨æ­¤å¤„ï¼Œå“ªäº›æƒ³æ³•å’Œæ¦‚å¿µå°¤ä¸ºé‡è¦-imp wordï¼Ÿ</li>
<li>ä½œè€…æ˜¾ç„¶é»˜è®¤æˆ‘åº”è¯¥æ˜ç™½è¿™ä¸ªå£°æ˜ä¸ºä»€ä¹ˆæ­£ç¡®ãƒ¼ãƒ¼é‚£ä¹ˆä¸ºä»€ä¹ˆå®ƒæ˜¯æ­£ç¡®çš„å‘¢ï¼Ÿ  - pre condition</li>
<li>ä½œè€…åœ¨å¼ºè°ƒè¿™ä¸ªç»†èŠ‚ãƒ¼ãƒ¼é‚£ä¹ˆï¼Œå®ƒä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ  -</li>
<li>åœ¨æ­¤å¤„ï¼Œä½œè€…ä¼¼ä¹è¿›è¡Œäº†å¯¹æ¯”ãƒ¼ãƒ¼é‚£ä¹ˆï¼Œå¯¹æ¯”ç‚¹åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>è¿™ä¸ªç»†èŠ‚å’Œæˆ‘å·²æœ‰çš„ç‰©ç†çŸ¥è¯†æœ‰ä»€ä¹ˆè”ç³»ï¼Ÿ</li>
<li>å¦‚æœæˆ‘é®ä½è¿™ä¸ªä¾‹å­åªå‰©å®ƒçš„å¼€å¤´ï¼Œé‚£ä¹ˆæˆ‘èƒ½å¤Ÿè‡ªè¡Œæ¨å¯¼å‡ºå‰©ä¸‹çš„å†…å®¹å—ï¼Ÿ</li>
<li>æˆ‘åˆšæ‰å¼„é”™äº†ãƒ¼ãƒ¼æˆ‘ç†è§£äº†çŠ¯é”™çš„åŸå› å—? æˆ‘èƒ½è§£é‡Šæˆ‘çš„è¯¯è§£å—ï¼Ÿ</li>
<li>å½“ç„¶è¿˜æœ‰ï¼šæˆ‘èƒ½ç®€å•å›å¿†ä¸€ä¸‹ä¸Šä¸€é¡µè¯´äº†ä»€ä¹ˆå—ï¼Ÿ</li>
</ul>
<hr>
<p>åšå­¦æœ¯ç ”ç©¶çš„è¯»è€…ä¼šå¯¹è¿™äº›é—®é¢˜æ¯”è¾ƒç†Ÿæ‚‰ã€‚åœ¨ã€Š<a href="http://andymatuschak.org/files/papers/Adler,%20van%20Doren%20-%201972%20-%20How%20to%20Read%20a%20Book.pdf">å¦‚ä½•é˜…è¯»ä¸€æœ¬ä¹¦</a>ã€‹ä¸­ï¼ŒAdler å’Œ van Doren è®¤ä¸ºï¼Œä¸ºç†è§£è€Œé˜…è¯»çš„æœ¬è´¨æ˜¯å‘ä¹¦æœ¬æå‡ºé—®é¢˜ï¼Œå¹¶å°è¯•å›ç­”è¿™äº›é—®é¢˜ã€‚</p>
<ul>
<li>è¦æ±‚ä¸é«˜çš„è¯»è€…ã€Œä¸æä»»ä½•é—®é¢˜â€”â€”ä¹Ÿå¾—ä¸åˆ°ä»»ä½•ç­”æ¡ˆã€ã€‚æˆ‘æ˜¯åœ¨ä»¥ç›¸å½“æ™®é€šçš„æ–¹å¼ä¸¥æ ¼è¦æ±‚ã€‚</li>
</ul>
<p>Adler å’Œ van Doren ç»™äº†æˆ‘ä»¬ä¸€ä¸ªè¿‡åº¦ç®€åŒ–çš„å¯¹æ¯”ï¼š
ã€Œä¸ºäº†è·å–ä¿¡æ¯è€Œé˜…è¯»ã€å’Œã€Œä¸ºäº†ç†è§£è€Œé˜…è¯»ã€ï¼Œ
å³èƒ½å¤Ÿè¯´å‡ºä½œè€…åœ¨è¯´<strong>ä»€ä¹ˆ</strong>ï¼ˆä¿¡æ¯ï¼‰ï¼Œä¸èƒ½å¤Ÿè¯´å‡ºä»–çš„<strong>æ„æ€</strong>ä»¥åŠä»–<strong>ä¸ºä»€ä¹ˆ</strong>è¿™ä¹ˆè¯´ï¼ˆç†è§£ï¼‰ä¹‹é—´çš„åŒºåˆ«ï¼ˆ* è¯‘è€…æ³¨ï¼šè¿™ä¸¤è€…éƒ½èƒ½å›ç­”ã€ŒWhatã€ï¼Œä½†å‰è€…è‡³å°‘ä¸èƒ½å›ç­”ã€Œå¦å¤–ä¸€ä¸ªåœºæ™¯ä¸‹æˆ‘æ€ä¹ˆç”¨ã€ï¼‰</p>
<hr>
<p>åœ¨å‰æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨çš„æ˜¯åœ¨ç†è§£ä½œè€…åœ¨è¯´<strong>ä»€ä¹ˆ</strong>æ—¶é¢ä¸´çš„é—®é¢˜ã€‚æˆ‘ä»¬çœ‹åˆ°å­¦ç”Ÿè¢«è¦æ±‚é™ˆè¿°æ–‡æœ¬çš„ä¸»æ—¨ï¼Œè€Œä¸æ˜¯è¿›è¡Œå¤æ‚çš„æ¨ç†ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒDwarkesh é”™è¿‡äº†å…³äºæ„ä¹‰å’Œæš—ç¤ºçš„ç»†èŠ‚ã€‚</p>
<p>è¿™äº›æ›´æ·±å±‚æ¬¡çš„å†…å®¹è¦æ±‚è¯»è€…è¶…è¶Šå°åœ¨å­—é¢çš„ä¸œè¥¿ï¼Œå› è€Œæ›´éš¾è·å¾—ã€‚å¦‚æœæ— æ³•ç†è§£ä½ ä¸“æ³¨é˜…è¯»çš„å¥å­ï¼Œå…¶æ–‡å­—å°±ä¼šè®©ä½ å›°æƒ‘ã€‚
å¦ä¸€æ–¹é¢ï¼Œå¦‚æœä½ ç†è§£ä¸€ä¸ªå¥å­çš„å­—é¢æ„æ€ï¼Œä½†é¢†ä¼šçš„ä¸æ˜¯ä½œè€…å®šä¹‰çš„é‚£ä¸ªæ„æ€ï¼Œå­—é¢ä¸Šçš„æ–‡å­—ä¸ä¸€å®šä¼šå¼•èµ·å›°æƒ‘ã€‚
åªæœ‰å½“ä½ å¤´è„‘ä¸­çš„æŸç§å£°éŸ³æŒç»­ä¸æ–­åœ°æå‡ºã€Œè¿™éƒ¨åˆ†å¦‚ä½•èå…¥æ•´ä½“ï¼Ÿã€è¿™æ ·çš„é—®é¢˜æ—¶ï¼Œä½ æ‰ä¼šæ³¨æ„åˆ°ã€‚è¿™æ ·é—®é¢˜ä¸ä¼šå°åœ¨é¡µé¢ä¸Šï¼Œç­”æ¡ˆé€šå¸¸ä¹Ÿä¸åœ¨ â€”â€” è‡³å°‘ä¸æ˜¯æ˜æ˜¾åœ°å‘ˆç°åœ¨é¡µé¢ä¸Šã€‚</p>
<h2><strong>é˜…è¯»ç†è§£ä¸è®°å¿†ç³»ç»Ÿä¹‹é—´çš„ç›¸äº’ä½œç”¨</strong></h2>
<p>å¦‚æœç›®æ ‡æ˜¯å¸®åŠ©äººä»¬å¯é åœ°å†…åŒ–å›°éš¾çš„æ–‡æœ¬ â€”â€” ä¸ä»…çŸ¥é“å®ƒä»¬åœ¨è¯´ä»€ä¹ˆï¼Œè¿˜ç†è§£å®ƒä»¬çš„å«ä¹‰å’Œã€Œwhyã€â€”â€”é‚£ä¹ˆç›´æ¥å…³æ³¨è®°å¿†å¯èƒ½æ˜¯æœ¬æœ«å€’ç½®äº†ã€‚</p>
<hr>
<p>æˆ‘æ›¾è¯•å›¾ä¸º Alex æä¾›ä¸€ä¸ªè®°å¿†ç³»ç»Ÿ</p>
<ul>
<li>ä½†ä»–åœ¨å¤ä¹ ç¯èŠ‚ä¸­å¸¸æ„Ÿåˆ°ç—›è‹¦å’ŒæŠ˜ç£¨ï¼šè®¸å¤šå¡ç‰‡ï¼Œä»–è§‰å¾—ç­”æ¡ˆä»¤äººå›°æƒ‘ï¼Œæˆ–æ˜¯ä¸æ˜ç™½å®ƒçš„é‡è¦æ€§ï¼Œæˆ–æ˜¯è§‰å¾—è‡ªå·±åœ¨æœºæ¢°å¤è¿°è€ŒéçœŸæ­£ç†è§£ã€‚</li>
<li>æ— è®ºæ˜¯å¤ä¹ èŠ±è´¹çš„æ—¶é—´ã€éš¾åº¦è¿˜æ˜¯æ”¶ç›Šï¼Œéƒ½æ¯”æˆ‘é¢„æœŸçš„æ¥å¾—åã€‚ç†æ‰€å½“ç„¶åœ°ï¼ŒAlex é€æ¸åæ„Ÿè®°å¿†ç»ƒä¹ ã€‚
æˆ‘è¶Šæ¥è¶Šå€¾å‘äºè®¤ä¸ºè¿™äº›é—®é¢˜çš„æ ¹æºåœ¨äºé˜…è¯»ç†è§£ã€‚</li>
<li>å½“ Alex å‘ç°å¡ç‰‡çš„ç­”æ¡ˆä»¤äººå›°æƒ‘æ—¶ï¼Œæˆ‘è®¤ä¸ºä»–é˜…è¯»åŸæ–‡ä¸­çš„ç›¸å…³è§£é‡Šåä¾ç„¶ä¼šå›°æƒ‘ã€‚</li>
<li>å› æ­¤ï¼Œè¿™äº›é—®é¢˜å¾ˆå¯èƒ½ä¸æ˜¯ç”±é—å¿˜å¼•èµ·çš„ï¼Œé™¤é Alex åœ¨é˜…è¯»æ—¶ç”±äºå¯¹å‰ææ¦‚å¿µçš„è®°å¿†è¾ƒå·®å¯¼è‡´è®¤çŸ¥è´Ÿè·è¿‡é«˜ã€‚</li>
<li>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ æ²¡è®°æ¸…ç”µåœºçš„åŸºæœ¬ç»†èŠ‚ï¼Œä½ å°±ä¼šéš¾ä»¥ç†è§£ä¸‹ä¸€ç« å…³äºé«˜æ–¯å®šå¾‹çš„è§£é‡Šã€‚</li>
</ul>
<hr>
<p>ä½†æ˜¯ä»–å¯¹ç¬¬ä¸€ç« çš„å¡ç‰‡ä¹Ÿæœ‰å›°éš¾ï¼Œæ‰€ä»¥è¿™å¹¶ä¸èƒ½å®Œå…¨è§£é‡Šç›®å‰å‘ç”Ÿçš„äº‹æƒ…ã€‚
é¦–å…ˆï¼Œè¯·ä½ ç†è§£ææ–™ï¼›ç„¶åï¼Œæˆ‘ä»¬ä¼šç¡®ä¿ä½ è®°ä½å®ƒã€‚
è¿™æ˜¯ä¸¤ä¸ªäº’ç›¸ç‹¬ç«‹çš„é—®é¢˜ã€‚ä½†è®°å¿†ç³»ç»Ÿçš„å¡ç‰‡ä¸ç†è§£è¿‡ç¨‹ä¹‹é—´å¯èƒ½å­˜åœ¨æ›´å¤æ‚çš„å…³ç³»</p>
<h3><strong>é—®é¢˜åµŒå…¥æ–‡å†…ï¼Œä¿ƒè¿›ç†è§£</strong></h3>
<p>æˆ‘ä»¬å°†æå–ç»ƒä¹ ç›´æ¥ç©¿æ’è¿›æ–‡æœ¬ä¸­ï¼Œå› æ­¤æ¯é˜…è¯»å‡ åˆ†é’Ÿåï¼Œä½ å°±ä¼šåœä¸‹æ¥å›ç­”å…³äºåˆšåˆšé˜…è¯»å†…å®¹çš„é—®é¢˜ã€‚
é‡åˆ°åµŒå…¥é—®é¢˜å¯èƒ½ä¼šå‘ä½ ã€Œæ­éœ²ã€ä½ æ²¡æœ‰ç†è§£ææ–™çš„å¤§äº‹å®ï¼Œä»è€Œã€Œä¿ƒä½¿ã€ä½ å»ç†è§£ææ–™ï¼ˆä¾‹å¦‚æ›´ä»”ç»†åœ°é‡è¯»ï¼‰ã€‚è¿™äº›æ•ˆåº”å±•ç°äº†ä¸€ä¸ªæ¯”çº¿æ€§çš„ã€Œç†è§£ -&gt; è®°å¿†ã€çš„è¿‡ç¨‹æ›´ä¸ºå¤æ‚çš„æ¨¡å‹ã€‚</p>
<p>æŠ›å¼€å…·ä½“çš„æ‰§è¡Œç­–ç•¥ä¸è°ˆï¼Œé˜…è¯»ç†è§£åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šä¸è‡ªæˆ‘è°ƒèŠ‚æœ‰å…³ã€‚
ä½ åº”è¯¥ä»¥å¤šå¿«çš„é€Ÿåº¦é˜…è¯»ï¼Ÿä½ åº”è¯¥å…³æ³¨ä»€ä¹ˆï¼Ÿä½ åº”è¯¥å¯¹æ–‡æœ¬æå‡ºä»€ä¹ˆæ ·çš„é—®é¢˜ï¼Ÿä½ å½“å‰çš„è¡Œä¸ºåœ¨å¤šå¤§ç¨‹åº¦ä¸Šäº§ç”Ÿäº†ä½ æƒ³è¦çš„ç»“æœï¼Ÿ
åµŒå…¥ç»ƒä¹ åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¤–åŒ…äº†è¿™äº›é—®ç­”ã€‚
åµŒå…¥çš„å¡ç‰‡å»ºæ¨¡äº†ï¼ˆä¸€ç§ç‰¹å®šç±»å‹çš„ï¼‰ã€ŒæˆåŠŸã€é˜…è¯»è¡Œä¸ºæ¨¡å¼ï¼Œå®ƒæä¾›äº†åé¦ˆï¼Œå¹¶åˆ›é€ å‡ºæ€è€ƒå’Œæ•´åˆä¿¡æ¯çš„è‡ªç„¶åœé¡¿ã€‚</p>
<hr>
<p>å…³äºæ–‡æœ¬ä¸­çš„ã€Œé™„åŠ é—®é¢˜ã€çš„å››ä¸ªæ˜æ˜¾çš„æ•ˆåº”ï¼š</p>
<ol>
<li>specific backward effectsï¼šä½ è¢«é—®è¿‡åï¼Œä½ ä¼šå€’å›å»ç•™æ„ä»¥å‰æ²¡æ³¨æ„çš„ï¼Œä¹Ÿä¼šæ›´ç•™æ„ä»¥åç›¸å…³çš„ï¼‰</li>
<li>general backward effectsï¼šé—®é¢˜ä¼šå¼•å‘å¯¹å‘¨è¾¹ç¯ç»•æ–‡æœ¬å’Œç›¸å…³æ¦‚å¿µçš„è„‘å†…å›é¡¾ï¼Œå¹¶è¿›è¡Œæ·±åº¦åŠ å·¥ï¼›è¡¨ç°ä¸ä½³å¯èƒ½ä¼šä¿ƒä½¿ä½ é‡æ–°é˜…è¯»æ–‡æœ¬</li>
<li>specific forward effectsï¼šåœ¨åç»­æ–‡æœ¬é‡Œï¼Œä½ ä¼šæ›´åŠ å…³æ³¨é—®é¢˜æ‰€æ¶‰åŠçš„å†…å®¹ï¼›ä½ å¯¹ç›¸å…³çš„åç»­ææ–™ä¼šæœ‰æ›´å¥½çš„å›å¿† [5]</li>
<li>ä¸€èˆ¬åæº¯æ•ˆåº”ï¼ˆgeneral forward effectsï¼‰ï¼šå†åç»­é˜…è¯»æ—¶ï¼Œä½ ä¼šæ›´åŠ ä¸“æ³¨ï¼ŒåŒ…æ‹¬å¯¹äºæ— å…³ææ–™çš„ä¸“æ³¨ï¼›å¦‚æœå‘ç°è‡ªå·±è¡¨ç°ä¸ä½³ï¼Œä½ å¯èƒ½ä¼šé˜…è¯»å¾—æ›´æ…¢ã€æ›´ä»”ç»†</li>
</ol>
<h3><strong>å¤ä¹ ç¯èŠ‚ä¿ƒè¿›ç†è§£</strong></h3>
<p>è®©æˆ‘ä»¬è®¨è®ºä½ é¦–æ¬¡é˜…è¯»ä¹‹åæœ€åˆçš„å¤ä¹ é˜¶æ®µï¼Œåœ¨å‡ å¤©å’Œå‡ å‘¨å†…ã€‚</p>
<p>å¦‚æœåœ¨è¿™ä¸ªé˜¶æ®µï¼Œä½ å‘ç°è‡ªå·±å®Œå…¨ä¸èƒ½ç†è§£æŸå¼ å¡ç‰‡ï¼Œé‚£ä¹ˆè¿›è¡Œå›å¿†ç»ƒä¹ å¯èƒ½å¯¹ä½ çš„ç†è§£å¸®åŠ©ä¸å¤§ï¼Œé™¤éè¿™ä¿ƒä½¿ä½ é‡æ–°é˜…è¯»åŸæ–‡ã€‚</p>
<p>ä½†è¿™ç§æ’ä¸Šã€Œä¸ç†è§£ã€çš„æ–¹å¼ï¼Œæ˜¯ä»¤äººä¸å¿«çš„ã€‚
ä½ ä¸åœ¨ä¹¦æ¡Œå‰ï¼›å¾ˆéš¾æ‰¾åˆ°åŸæ–‡æœ¬ï¼›ä½ è¦ä¹ˆæ‰“æ–­å¤ä¹ è¿‡ç¨‹å»é‡è¯»ï¼ˆå¾ˆéº»çƒ¦ï¼‰ï¼Œè¦ä¹ˆæ ‡è®°è¯¥æ¦‚å¿µä»¥ä¾›ä¹‹åå­¦ä¹ ï¼ˆä¸é è°±ï¼‰ã€‚</p>
<p>æˆ‘å’Œ Alex åšå®éªŒæ—¶ï¼Œè¿˜ä¸åƒåŠ©è®°åª’ä»‹é‚£æ ·å°†é—®é¢˜åµŒå…¥åˆ°ä»–çš„é˜…è¯»ä¸­ï¼Œæ‰€ä»¥ä»–çš„æ„Ÿè§‰æ˜¯ï¼Œå¸¸å¸¸ã€Œå‡ å¤©åæ‰å‘ç°ç†è§£é—®é¢˜ã€ã€‚</p>
<p>ä½†å¯¹äºå¹¶éå®Œå…¨ä¸èƒ½ç†è§£çš„ä¾‹å­æ¥è¯´ï¼Œå¤ä¹ ç¯èŠ‚ä¸ºæ›´æ·±å…¥çš„ç†è§£æä¾›äº†ä¸€ä¸ªå¾ˆå¥½çš„æœºä¼šã€‚</p>
<p>å½“ä½ åœ¨å‡ å¤©æˆ–å‡ å‘¨åå†æ¬¡å›ç­”æ—¶ï¼Œä½ å¯èƒ½ä¼šä»¥ç¨å¾®ä¸åŒçš„è§’åº¦çœ‹å¾…å®ƒã€‚
ä¹Ÿè®¸ä½ å·²ç»é˜…è¯»äº†æ›´å¤šä¾èµ–äºè¿™ä¸ªæ¦‚å¿µçš„ææ–™ï¼Œæˆ–è€…ä½ å·²ç»ç”¨å®ƒæ¥è§£å†³è¿‡é—®é¢˜ï¼Œæˆ–è€…ä½ æ›¾åœ¨è°ˆè¯ä¸­æåˆ°è¿‡å®ƒã€‚</p>
<h3><strong>æå–ä¿ƒä½¿å¢è¿›ç†è§£çš„è¡ŒåŠ¨å‘ç”Ÿ</strong></h3>
<p>åœ¨çº¿æ€§çš„ã€Œå…ˆç†è§£åè®°å¿†ã€æ¨¡å‹ä¸­ï¼Œä½ å·²ç»å®Œæˆäº†ç¬¬ä¸€éƒ¨åˆ†ã€‚</p>
<p>ä½†æ˜¯ï¼Œå½“ä½ å°è¯•åœ¨ä¸€é“ç®€å•çš„ç»ƒä¹ é¢˜ä¸­ä½¿ç”¨é«˜æ–¯å®šå¾‹æ—¶ï¼Œæ„Ÿåˆ°å¾ˆè´¹åŠ²ã€‚</p>
<ul>
<li>ä½ ä¸æ–­åœ°ç¿»å›å»æŸ¥çœ‹å®šä¹‰å’Œç¤ºä¾‹ã€‚å¦‚æœä½ èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ ä¼šæ›´æ·±å…¥åœ°ç†è§£é«˜æ–¯å®šå¾‹ã€‚</li>
<li>ä¾‹å¦‚ï¼Œä½ ä¼šç›´è§‚åœ°ç†è§£å…¬å¼è¡¨é¢ç§¯åˆ†é‡Œç‚¹ä¹˜çš„ç»“æœã€‚</li>
<li>ä½†æ˜¯å¯¹ææ–™çš„è®°å¿†ä¸ç‰¢å›ºï¼Œå¯¼è‡´ä½ å¾ˆéš¾è§£ç­”è¿™ä¸ªä¹ é¢˜ã€‚å¦‚æœä½ åœ¨å‡ å¤©å†…å¤ä¹ äº†ç›¸å…³çš„å¡ç‰‡ï¼Œä½ å°±èƒ½å°†è¿™äº›ç»†èŠ‚åˆå¹¶ä¸ºæ›´é«˜å±‚æ¬¡çš„ç»„å—ï¼Œå¹¶å»ºç«‹ç›¸å…³è¿æ¥ï¼Œè¿™äº›è¿æ¥ä¼šå¸®ä½ åœ¨è§£å†³é—®é¢˜æ—¶ä»¥æ­£ç¡®çš„æ—¶æœºæå–åˆ°æ­£ç¡®çš„çŸ¥è¯†ç»†èŠ‚ã€‚</li>
</ul>
<p>åœ¨è¿™ä¸ªæ•…äº‹ä¸­ï¼Œæˆ‘ä»¬ç¿»è½¬äº†ã€Œå…ˆç†è§£åè®°å¿†ã€çš„æ¨¡å¼ï¼šåè€Œæ˜¯è®°å¿†å¸®åŠ©äº†ä½ åˆ›é€ æŸç§ç†è§£ã€‚</p>
<h3><strong>åˆ¶å¡ä¿ƒè¿›ç†è§£</strong></h3>
<p>è¿™ä¸ªè·¯çº¿è¦æ±‚å¾ˆè‹›åˆ»ã€‚è¦å†™å‡ºå¥½çš„åŠ©è®°å¡ç‰‡ï¼Œä½ å¿…é¡»ä¸æ–­åœ°æ€è€ƒï¼šè¿™</p>
<ul>
<li>æ®µæ–‡æœ¬çš„å“ªäº›éƒ¨åˆ†å¾ˆé‡è¦ï¼Œå“ªäº›ä¸é‡è¦ï¼Ÿ</li>
<li>
<ul>
<li>æˆ‘èƒ½ç”¨è‡ªå·±çš„è¯è¡¨è¿°è¿™ä¸ªæ¦‚å¿µå—ï¼Ÿè¿™ä¸ªæ¦‚å¿µä¸æˆ‘å·²çŸ¥çš„å…¶ä»–å†…å®¹æœ‰ä»€ä¹ˆè”ç³»ï¼Ÿå®ƒä¸æˆ‘çš„å…´è¶£æœ‰ä»€ä¹ˆè”ç³»ï¼Ÿæˆ‘èƒ½æ‰¾åˆ°æ¦‚å¿µé‡Œéœ€è¦å†™æˆå¡ç‰‡çš„è¾¹ç•Œæ¡ä»¶å—ï¼Ÿæˆ‘èƒ½ä¸ºå®é™…é—®é¢˜ç”Ÿæˆä¸€äº›ä¾‹å­å—ï¼Ÿæˆ‘èƒ½è§‚å¯Ÿåˆ°ä½œè€…çš„å¿ƒæ™ºæ¨¡å‹æˆ–åŠ¨æœºçš„é‡è¦ä¹‹å¤„å—ï¼Ÿ</li>
</ul>
</li>
</ul>
<p>è¿™äº›ç¼–å†™å¡ç‰‡çš„é—®é¢˜åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šä¸ä¸ºç†è§£è€Œé˜…è¯»çš„é—®é¢˜ç›¸é‡å ã€‚è€Œä¸”åœ¨ä¸¤ç§æƒ…å†µä¸‹ï¼Œä½ éƒ½ç»å¸¸ä¼šå‘ç°ï¼Œè‡ªå·±å› ä¸ºæ²¡æœ‰ä»”ç»†é˜…è¯»è€Œæ— æ³•å›ç­”è¿™äº›é—®é¢˜ã€‚è¿™ç»™äº†ä½ ä¸€äº›è°ƒèŠ‚é˜…è¯»æ‰€éœ€çš„åé¦ˆã€‚</p>
<hr>
<p>åœ¨ä¸Šä¸€æ®µä¸­æåˆ°çš„é—®é¢˜æ˜¯ä½ ä¼šå¯¹æ–‡æœ¬æå‡ºçš„é—®é¢˜ï¼Œä½†æ˜¯éšç€ä½ æ›´å¥½åœ°ç†è§£ç¼–å†™å¡ç‰‡çš„åª’ä»‹çš„å†…ç¦€ã€Œç²’åº¦ã€ï¼Œä½ ä¼šæ³¨æ„åˆ°ä½ ä¹Ÿä¼šå¯¹è‡ªå·±çš„<strong>å¡ç‰‡</strong>æå‡ºä¸Šè¿°é—®é¢˜ã€‚</p>
<ul>
<li>ä½ ä¼šçœ‹ç€ä½ å†™çš„å¡ç‰‡æ€è€ƒï¼šè¿™æ˜¯å¦æ¦‚æ‹¬äº†è¿™ä¸ªè§‚ç‚¹çš„æ ¸å¿ƒï¼Ÿä½ ä¼šå°è¯•å®Œå–„å¡ç‰‡ï¼šè¿™äº›ç»†èŠ‚ä¸­æ˜¯å¦æœ‰ä¸å¿…è¦çš„ã€å¯å»é™¤çš„éƒ¨åˆ†ï¼Ÿä½ ä¼šæƒ³çŸ¥é“ï¼šæˆ‘æ˜¯å¦æ•æ‰åˆ°ï¼ˆæ¦‚å¿µèŠ‚ç‚¹ä¹‹é—´ï¼‰æ‰€æœ‰é‡è¦çš„è”ç³»ï¼Ÿä½ å·²ç»å†™äº†ä¸€å¼ å¡ç‰‡æ¥é™ˆè¿° A æ˜¯<strong>è¿™ä¸ª</strong>æƒ…å†µï¼›æ‰€ä»¥ç°åœ¨ä½ è‡ªç„¶åœ°ä¼šé—®ï¼šæˆ‘èƒ½å¦å†™ä¸€å¼ å¡ç‰‡å…³äº A <strong>ä¸ºä»€ä¹ˆ</strong>æ˜¯è¿™ä¸ªæƒ…å†µçš„ï¼Ÿé€šè¿‡å›ç­”è¿™äº›é—®é¢˜ï¼Œä½ å¯¹äºæ‰€è¯»ææ–™çš„æŠŠæ¡ä¼šæ›´åŠ æ˜æ™°ã€‚</li>
</ul>
<hr>
<p>æ‰€æœ‰è¿™äº›ï¼Œå¥‡æ€ªä¹‹å¤„åœ¨äºï¼Œè¡¨é¢ä¸Šä½ åˆ›å»ºè¿™äº›å¡ç‰‡æ˜¯ä¸ºäº†ä»¥åè®°ä½è¿™äº›ç»†èŠ‚ã€‚ä½†å¾ˆå¤šæ—¶å€™ï¼Œå¯èƒ½æ˜¯åˆ›å»ºå¡ç‰‡çš„è¿‡ç¨‹æœ¬èº«â€”â€”è€Œä¸æ˜¯åç»­çš„å¤ä¹  â€”â€” å¯¹ä½ çš„å­¦ä¹ ä½“éªŒå½±å“æ›´å¤§ã€‚</p>
<p>ä»¥è‡³äºä½ æ„Ÿè§‰å¯ä»¥æ‰”æ‰è¿™äº›å¡ç‰‡ï¼Œåªæ˜¯æŠŠå®ƒä»¬å½“ä½œä¸€ç§ç»“æ„åŒ–çš„ç¬”è®°æ–¹æ³•ã€‚å¯¹æ­¤ï¼Œ<a href="https://cognitivemedium.com/srs-mathematics">Michael Nielsen æŒ‡å‡º</a><a href="#ref_4">[4]</a>ï¼Œå¯¹å¡ç‰‡åç»­çš„ç»ƒä¹ æœ‰æå¤§çš„æ¿€åŠ±ä½œç”¨ã€‚</p>
<p>æŠ±ç€è®°ç¬”è®°çš„å¿µå¤´ï¼Œæœ‰æ—¶åƒæ˜¯åšæŠ½è±¡çš„ä½œä¸šï¼Œä½ çŸ¥é“ä½ å¯èƒ½æ°¸è¿œä¸ä¼šå†çœ‹è¿™äº›ç¬”è®°ï¼Œè¿™ä¼šä¾µèš€ä½ çš„åŠ¨åŠ›ã€‚
ä½†å¦‚æœä½ æœ‰è¿‡ã€Œè®°å¿†ç»ƒä¹ å¸®åŠ©ä½ è½»æ¾ç‰¢è®°å¤§é‡ç»†èŠ‚ã€çš„ç”¨æˆ·ä½“éªŒï¼Œå°±ä¼šå¯¹ã€Œä¸ºæœ‰è¶£æƒ³æ³•ç¼–å†™æ–°å¡ç‰‡ã€è‡ªåŠ¨äº§ç”Ÿä»·å€¼æ„Ÿã€‚
å³ä½¿å…¶ä¸­è®¸å¤šå¡ç‰‡å®é™…ä¸Šåªæ˜¯ã€Œç³Ÿç²•ã€ï¼Œæ˜¯å†™åå³ä¸¢çš„å¼•ç«ç‰©ï¼Œè¿™ä¸€ç‚¹ä¾ç„¶æ˜¯å¯¹çš„ã€‚ä½ ç”¨å®ƒä»¬æ¥ç†è§£ææ–™ï¼Œä»¥å†™å‡ºä¸€äº›ä½ çœŸæ­£å…³å¿ƒï¼Œæ„¿æ„å¤ä¹ çš„å¡ç‰‡ã€‚</p>
<p>å½“ç„¶ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸è´¹åŠ›ä¸”å›°éš¾çš„è¿‡ç¨‹ã€‚è¿™å¤§æ¦‚å°±æ˜¯ä¸ºä»€ä¹ˆåŠ©è®°åª’ä»‹ä¼šå®Œå…¨è‡ªåŠ¨åŒ–å¡ç‰‡ç¼–å†™è¿‡ç¨‹ã€‚ä¸€äº›è„šæ‰‹æ¶å¼çš„åŠè‡ªåŠ¨é¢†åŸŸä¹Ÿæ˜¯å€¼å¾—æ¢ç´¢çš„æœ‰è¶£ä¹‹å¤„ã€‚</p>
<h3><strong>ä»¥ç†è§£ä¸ºä¸­å¿ƒçš„æ–‡å†…é—®é¢˜</strong></h3>
<p>å‰æ–‡ï¼Œæˆ‘ä»¬è®¨è®ºäº†åœ¨åŠ©è®°åª’ä»‹ä¸­åµŒå…¥çš„é—®é¢˜ï¼Œæ˜¯å¦‚ä½•å¸®åŠ©æé«˜é˜…è¯»ç†è§£èƒ½åŠ›çš„ã€‚ä½†å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å¹¶ä¸å…¨éƒ½ã€Œè¯•å›¾ã€è¿™ä¹ˆåšã€‚</p>
<p>è¿™ä¸ªé—®é¢˜å¾ˆæœ‰æ„æ€ï¼šå¦‚æœä»¥å¢å¼ºé˜…è¯»ç†è§£èƒ½åŠ›ä¸ºä¸»è¦ç›®æ ‡ï¼Œä½ ä¼šæ€ä¹ˆè®¾è®¡å‘¢ï¼Ÿ</p>
<ul>
<li>æ¯”å¦‚åªæ˜¯ä¸ºäº†åœ¨å…ƒè®¤çŸ¥ä¸Šè·å¾—åŒæ ·çš„æ”¶ç›Šï¼Œä½ å¯èƒ½ä¸éœ€è¦é—®é‚£ä¹ˆå¤šçš„é—®é¢˜ã€‚</li>
<li>å¦‚æœåªæ˜¯ä¸ºäº†å…ƒè®¤çŸ¥ï¼Œæ›´å¥½çš„åšæ³•æ˜¯åœ¨å½“å¤©æå‡ºä¸€ä¸¤ä¸ªæ›´é«˜å±‚æ¬¡çš„ã€Œè§£é‡Šæ€§é—®é¢˜ã€ï¼Œè€Œæ¨è¿Ÿè®°å¿†ç»†èŠ‚åˆ°ç¬¬äºŒå¤©ã€‚
<ul>
<li>è§£é‡Šæ€§çš„é—®é¢˜æ—¨åœ¨ä¿ƒè¿›å¯¹æ–‡æœ¬çš„æ·±å±‚åŠ å·¥å’Œåæ€ï¼Œæˆ‘ä»¬ï¼ˆå›¾å®ƒçš„è¿‡ç¨‹ï¼‰è€Œä¸æ˜¯ç­”æ¡ˆæœ¬èº« â€”â€” ç­”æ¡ˆæœ¬èº«å¯èƒ½æ ¹æœ¬ä¸åœ¨æ–‡æœ¬ä¸­</li>
</ul>
</li>
<li>å¯¹äºå›å¿†ç±»å‹çš„å¡ç‰‡ï¼Œæˆ‘ä»¬åœ¨è®¾è®¡ä¸Šä¸é¼“åŠ±å›å¤´æŸ¥çœ‹æºæ–‡æœ¬ï¼›</li>
<li>ä½†å¯¹äºè¿™äº›ç†è§£ç±»çš„å¡ç‰‡ï¼Œæˆ‘ä»¬å¸Œæœ›ç•Œé¢ä¸Šçš„è®¾è®¡ä¸æ’æ–¥ç”šè‡³é¼“åŠ±ç”¨æˆ·å›æ»šé¡µé¢ã€å†æ¬¡é˜…è¯»</li>
</ul>
<h3><strong>è®¨è®ºé¢˜</strong></h3>
<p>æ•™ç§‘ä¹¦ä¹ é¢˜åˆ—è¡¨ä¸­çš„è§£é‡Šæ€§é—®é¢˜ï¼Ÿä¸è¡Œï¼Œæ— èŠï¼Œæˆ‘ä¸åœ¨ä¹ã€‚ä½†æ˜¯åœ¨èŠåŠ å“¥å¤§å­¦çš„è¯¾å ‚ä¸Šï¼Œè®²å¸ˆé—®äº†æˆ‘ä¸€äº›è§£é‡Šæ€§é—®é¢˜ï¼Œæˆ‘å‘ç°æˆ‘æ„¿æ„å›ç­”å®ƒä»¬
æˆ‘è®¤ä¸ºåŒºåˆ«ä¸»è¦åœ¨äºç¤¾äº¤ç¯å¢ƒã€‚è€Œç¤¾äº¤ç¯å¢ƒå¼ºåŒ–äº†æˆ‘çš„å‚ä¸æ„Ÿã€‚å½“æˆ‘å¤„äºã€Œä»”ç»†åŠ å·¥æ–‡æœ¬ä»¥ç¼–å†™å¡ç‰‡çš„æ¨¡å¼ã€æ—¶ï¼Œæˆ‘çš„ç†è§£åŠ›ç›¸å½“å¥½ã€‚ä½†åœ¨ä¸é‚£ä¹ˆæç«¯çš„æƒ…å†µä¸‹ï¼Œæˆ‘ç»å¸¸ä¼šçŠ¯é”™ã€‚æˆ‘å¸Œæœ›æœ‰ä¸€ç§é˜…è¯»å¢å¼ºæŠ€æœ¯ï¼Œå¯ä»¥å¸®åŠ©ç¡®ä¿æˆ‘å¯¹ä¸€ç¯‡æ–‡æœ¬çš„ç†è§£è¾¾åˆ°æˆ‘æœŸæœ›çš„æ·±åº¦â€”â€”åªè¦è¿™ç§å¢å¼ºä¸ä¼šå¸¦æ¥è¿‡äºæ²‰é‡çš„è´Ÿæ‹…ã€‚</p>
<p>è¿™äº›è®¨è®ºç¡®å®èƒ½å¤Ÿå¢å¼ºæˆ‘çš„ç†è§£åŠ›ï¼Œå°½ç®¡è¿›å±•éå¸¸ç¼“æ…¢ï¼Œä¸”è¦†ç›–é¢æœ‰é™ã€‚è€Œä¸”ï¼Œæˆ‘åšä¸åˆ°å¯¹æˆ‘æ‰€é˜…è¯»çš„ä¸€åˆ‡éƒ½è½»æ¾åœ°ç»„ç»‡ä¸€åœºå…·æœ‰è‰¯å¥½å¼•å¯¼çš„è®¨è®ºã€‚</p>
<hr>
<p>è¿˜æœ‰ä¸€ä¸ªå¯æœŸçš„æ›¿ä»£æ–¹æ¡ˆï¼Œå¯èƒ½æ¥è¿‘äºã€Œ<a href="http://andymatuschak.org/files/papers/Simpson%20et%20al%20-%201994%20-%20Elaborative%20verbal%20rehearsals%20and%20college%20students'%20cognitive%20performance.pdf">å°½è¨€å¤è¿°</a>ã€ã€‚
è¿™æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ç»ƒä¹ ï¼šåœ¨é˜…è¯»å®Œä¸€æ®µæ–‡å­—åï¼Œé—­ä¸Šçœ¼ç›ç”¨è‡ªå·±çš„è¯è§£é‡Šå…¶å†…å®¹ã€‚</p>
<hr>
<p><a href="http://andymatuschak.org/files/papers/Simpson%20et%20al%20-%201994%20-%20Elaborative%20verbal%20rehearsals%20and%20college%20students'%20cognitive%20performance.pdf">å°½è¨€å¤è¿°</a>è¿™ç§æ–¹å¼ä¸é—®ç­”çš„ç›¸ä¼¼ç‚¹æ˜¯ï¼Œå®ƒä»¬éƒ½å¯ä»¥åŠ å¼ºåŸºç¡€ç†è§£åŠ›ï¼Œ
ä½†ä¸¤è€…çš„æƒ…ç»ªæ„Ÿå—å´éå¸¸ä¸åŒã€‚ç‰¹åˆ«æ˜¯ï¼Œå®ƒä¸ä¼šè®©æˆ‘è§‰å¾—åœ¨å›ç­”ä¸€ä¸ªæˆ‘ä¸å…³å¿ƒçš„æ— èŠé—®é¢˜ã€‚</p>
<ul>
<li>å¯¹äº†ï¼Œè¿™é‡Œä¹Ÿæœ‰ä¸€äº›æœ‰è¶£çš„å¢å¼ºçš„ä½™åœ°ã€‚ä¾‹å¦‚ï¼Œç›®æ ‡æ–‡æœ¬å¯èƒ½æœ‰ä½ åœ¨è§£é‡Šä¸­æ²¡æœ‰åŒ…å«çš„é‡è¦ç»†èŠ‚ï¼Œå› æ­¤å¯ä»¥åœ¨å®æ—¶ç”Ÿæˆçš„è¯­éŸ³æ–‡ç¨¿ä¸Šè¿›è¡Œæ¶‚ç”»ï¼Œåœˆå‡ºä¸å®ƒç›¸å†²çªçš„éƒ¨åˆ†ã€‚</li>
<li>å†æ¯”å¦‚å¯ä»¥ç”¨ä¸€äº›æ ‡è®°æ‰“åœ¨æ–‡æœ¬ä¸Šï¼Œåæ˜ ä½ ç†è§£äº†æ–‡æœ¬çš„å«ä¹‰ï¼Œä½†ä¸çŸ¥é“å®ƒä¸ºä»€ä¹ˆæ˜¯é‡ç‚¹ã€‚</li>
</ul>
<p>å®ç”¨è§’åº¦ä¸Šï¼Œæœ‰ä¸€ä¸ªé‡è¦çš„é—®é¢˜äºŸå¾…è§£å†³ï¼šè¢«è¦æ±‚è®°ä½ä»æœªç†è§£çš„ç»†èŠ‚ä»¤äººéå¸¸ä¸å¿«ã€‚</p>
<ul>
<li>é¿å…è¿™ç§æƒ…å†µçš„ä¸€ç§æ–¹æ³•æ˜¯ä¿ƒè¿›ç†è§£ï¼Œæ­£å¦‚æˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„é‚£æ ·ï¼›</li>
<li>å¦ä¸€ç§æ–¹æ³•æ˜¯é¿å…é—®åŠå°šæœªç†è§£çš„ææ–™ã€‚</li>
<li>ä¹Ÿè®¸å°½è¨€å¤è¿°æä¾›äº†ä¸€ç§å®ç°åè€…çš„æ–¹å¼ï¼šæˆ‘ä»¬åªä¼šè¦æ±‚ä½ è®°ä½ä½ çš„è§£é‡Šä¸­åŒ…å«çš„ç»†èŠ‚ã€‚</li>
</ul>
<h3><strong>å¼€å·ç»ƒä¹ </strong></h3>
<p>è¿™äº›ä»»åŠ¡æ—¨åœ¨ä»å†…éƒ¨äº§ç”Ÿç†è§£ â€”â€” å³ï¼šé€šè¿‡è§£å†³æŸç§ç±»å‹çš„é—®é¢˜ï¼Œä½ ä¼šè·å¾—æŸç§ç±»å‹çš„æ´è§ã€‚</p>
<p>å½“å‰çš„å¤ä¹ ç¯èŠ‚çš„æ¨¡å¼å­˜åœ¨ä¸€ä¸ªé™åˆ¶ï¼Œå³å®ƒä¸æ–‡æœ¬æ˜¯åˆ†ç¦»çš„ï¼›</p>
<ul>
<li>å®ƒåŸºæœ¬ä¸Šå‡è®¾ä½ åœ¨ç¬¬ä¸€æ¬¡é˜…å¤ä¹ è¯»æ—¶å°±å®Œå…¨ã€Œç†è§£ã€äº†ä¸€åˆ‡ã€‚å¦‚æœä½ æ²¡æœ‰ç†è§£ï¼Œé‚£ä¹ˆå°±ä¸€å®šè§†ä½œä¸€ç§ç®€å•çš„è®°å¿†å¤±è´¥ã€‚</li>
<li>è€Œå¤ä¹ ç¯èŠ‚å®é™…ä¸Šæ— æ³•åŒ…å«å¯ä»¥å¼•å¯¼ä½ é‡æ–°è§£è¯»æ–‡æœ¬æé—®ã€‚</li>
</ul>
<p>æˆ‘æƒ³è±¡ä¸­ï¼Œå¯ä»¥å›´ç»•ã€Œå¼€å·è€ƒè¯•ã€è®¾è®¡ä¸€ç§å¤ä¹ ç•Œé¢ã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œ</p>
<ul>
<li>åœ¨å±å¹•çš„ä¸€ä¾§æµ®åŠ¨ä¸€ä¸ªå¡ç‰‡ï¼Œè€Œå…¶ä½™éƒ¨åˆ†åˆ™ç”¨äºæ˜¾ç¤ºåŸå§‹æ–‡æœ¬ã€‚</li>
<li>ç»“æ„åŒ–ã€è¾…åŠ©å¼ã€æœ‰ç›®çš„çš„é‡è¯»å¯ä»¥ç›´æ¥èå…¥åˆ°å¤ä¹ ä½“éªŒä¸­ã€‚</li>
</ul>
