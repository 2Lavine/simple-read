> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [juejin.cn](https://juejin.cn/post/6913568633813729294?searchId=202309121411033BA3E28C284DBAA99D28)

容器化时代来了
-------

虚拟化技术已经走过了三个时代，没有容器化技术的演进就不会有 Docker 技术的诞生。
（1）物理机时代：多个应用程序可能会跑在一台机器上。
（2）虚拟机时代：一台物理机器安装多个虚拟机（VM），一个虚拟机跑多个程序。
（3）容器化时代：一台物理机安装多个容器实例（container），一个容器跑多个程序。


---
容器化解决了软件开发过程中一个令人非常头疼的问题，用一段对话描述：
> 测试人员：你这个功能有问题。
> 开发人员：我本地是好的啊。

开发人员编写代码，在自己本地环境测试完成后，将代码部署到测试或生产环境中，经常会遇到各种各样的问题。明明本地完美运行的代码为什么部署后出现很多 bug，原因有很多：不同的操作系统、不同的依赖库等，总结一句话就是因为本地环境和远程环境不一致。

容器化技术的特点
----------
*   **可移植性**：不依赖具体的操作系统或云平台，比如在阿里云或腾讯云直接随意迁移。
*   **占地小**：容器只需要其应用程序以及它需要运行的所有容器和库的依赖清单，不需要将所有的依赖库都打包在一起    
*   **共享 bin 和 lib**：不同的容器可以共享 bin 和 lib，进一步节省了空间。

Docker 怎么用？
-----------

- 在运行容器前需要编写 Docker File，
- 通过 dockerFile 生成镜像，
- 然后才能运行 Docker 容器。
Docker File 定义了运行镜像（image）所需的所有内容，包括操作系统和软件安装位置。
一般情况下都不需要从头开始编写 Docker File，在 Docker Hub 中有来自世界各地的工程师编写好的镜像，你可以基于此修改。

编排系统的需求催生 k8s
-------------
尽管 Docker 为容器化的应用程序提供了开放标准，但随着容器越来越多出现了一系列新问题：
*   如何协调和调度这些容器？
*   如何在升级应用程序时不会中断服务？
*   如何监视应用程序的运行状况？
*   如何批量重新启动容器里的程序？

解决这些问题需要容器编排技术，可以将众多机器抽象，对外呈现出一台超大机器。
现在业界比较流行的有：k8s、Mesos、Docker Swarm。



---
一个成熟的容器编排系统需要具备以下能力：

*   处理大量的容器和用户
*   负载均衡
*   鉴权和安全性
*   管理服务通信
*   多平台部署


k8s 与 Docker Swarm 江湖恩怨
-----------------------
Docker Swarm 是 Docker 自家针对集群化部署管理的解决方案，优点很明显，可以更紧密集成到 Docker 生态系统中。
虽说 Swarm 是 Docker 亲儿子，但依旧没有 k8s 流行，不流行很大程度是因为商业、生态的原因，不多解释。

K8s 架构和组件
---------

k8s 由众多组件组成，组件间通过 API 互相通信，归纳起来主要分为三个部分：
*   **Controller Manager**，即控制平面，用于调度程序以及节点状态检测。
*   **Nodes**，构成了 Kubernetes 集群的集体计算能力，实际部署容器运行的地方。
*   **Pods**，Kubernetes 集群中资源的最小单位。
![[../_resources/317bc494b6a2222db8a1536ff17c6897_MD5.webp]]


