

Vuexæ˜¯ä¸€ä¸ªç¨‹åºé‡Œé¢çš„**çŠ¶æ€ç®¡ç†æ¨¡å¼**ï¼Œå®ƒæ˜¯**é›†ä¸­å¼**å­˜å‚¨**æ‰€æœ‰**ç»„ä»¶çš„çŠ¶æ€çš„å°ä»“åº“ï¼Œå¹¶ä¸”ä¿æŒæˆ‘ä»¬å­˜å‚¨çš„çŠ¶æ€ä»¥ä¸€ç§**å¯ä»¥é¢„æµ‹**çš„æ–¹å¼å‘ç”Ÿå˜åŒ–ã€‚

ç¬¬ä¸€æ­¥ï¼Œäº†è§£ Vuex
===========

### ğŸ¤¯ æƒ³è±¡ä¸€ä¸ªåœºæ™¯
å¦‚æœä½ çš„é¡¹ç›®é‡Œæœ‰å¾ˆå¤šé¡µé¢ï¼ˆç»„ä»¶ / è§†å›¾ï¼‰ï¼Œé¡µé¢ä¹‹é—´å­˜åœ¨å¤šçº§çš„åµŒå¥—å…³ç³»ï¼Œæ­¤æ—¶ï¼Œè¿™äº›é¡µé¢å‡å¦‚éƒ½éœ€è¦å…±äº«ä¸€ä¸ªçŠ¶æ€çš„æ—¶å€™ï¼Œæ­¤æ—¶å°±ä¼šäº§ç”Ÿä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š
*   å¤šä¸ªè§†å›¾ä¾èµ–åŒä¸€ä¸ªçŠ¶æ€
*   æ¥è‡ªä¸åŒè§†å›¾çš„è¡Œä¸ºéœ€è¦å˜æ›´åŒä¸€ä¸ªçŠ¶æ€

*   å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œ
	* å‡å¦‚æ˜¯å¤šçº§åµŒå¥—å…³ç³»ï¼Œä½ å¯ä»¥ä½¿ç”¨çˆ¶å­ç»„ä»¶ä¼ å‚è¿›è¡Œè§£å†³ï¼Œè™½æœ‰äº›éº»çƒ¦ï¼Œä½†å¥½åœ¨å¯ä»¥è§£å†³ï¼›
	* å¯¹äºå…„å¼Ÿç»„ä»¶æˆ–è€…å…³ç³»æ›´å¤æ‚ç»„ä»¶ä¹‹é—´ï¼Œå°±å¾ˆéš¾åŠäº†ï¼Œç­‰é¡¹ç›®åšå¤§äº†ï¼Œä»£ç å°±ä¼šå˜æˆå±å±±ï¼Œå®åœ¨ä»¤äººå¿ƒçƒ¦ã€‚
*   å¯¹äºç¬¬äºŒä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥é€šè¿‡çˆ¶å­ç»„ä»¶ç›´æ¥å¼•ç”¨ï¼Œæˆ–è€…é€šè¿‡äº‹ä»¶æ¥å˜æ›´æˆ–è€…åŒæ­¥çŠ¶æ€çš„å¤šä»½æ‹·è´ï¼Œè¿™ç§æ¨¡å¼å¾ˆè„†å¼±ï¼Œå¾€å¾€ä½¿å¾—ä»£ç éš¾ä»¥ç»´æŠ¤ï¼Œè€Œä¸”åŒæ ·ä¼šè®©ä»£ç å˜æˆå±å±±ã€‚

### ğŸ˜‡ æ¢ä¸€ç§æ€è·¯å‘¢ï¼š

*   æŠŠå„ä¸ªç»„ä»¶éƒ½éœ€è¦ä¾èµ–çš„åŒä¸€ä¸ªçŠ¶æ€æŠ½å–å‡ºæ¥ï¼Œåœ¨å…¨å±€ä½¿ç”¨å•ä¾‹æ¨¡å¼è¿›è¡Œç®¡ç†ã€‚
*   åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œä»»ä½•ç»„ä»¶éƒ½å¯ä»¥ç›´æ¥è®¿é—®åˆ°è¿™ä¸ªçŠ¶æ€ï¼Œæˆ–è€…å½“çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰çš„ç»„ä»¶éƒ½è·å¾—æ›´æ–°ã€‚

 è¿™æ—¶å€™ï¼ŒVuex è¯ç”Ÿäº†ï¼
- è¿™å°±æ˜¯ Vuex èƒŒåçš„åŸºæœ¬æ€æƒ³ï¼Œå€Ÿé‰´äº† Fluxã€Reduxã€‚
- ä¸å…¶ä»–æ¨¡å¼ä¸åŒçš„æ˜¯ï¼ŒVuex æ˜¯ä¸“é—¨ä¸º Vue è®¾è®¡çš„çŠ¶æ€ç®¡ç†åº“ï¼Œä»¥åˆ©ç”¨ Vue.js çš„ç»†ç²’åº¦æ•°æ®å“åº”æœºåˆ¶æ¥è¿›è¡Œé«˜æ•ˆçš„çŠ¶æ€æ›´æ–°ã€‚

### ğŸ¤© ä»€ä¹ˆæ—¶å€™åº”è¯¥ç”¨ vuex å‘¢ï¼Ÿ
*   å‡å¦‚ä½ çš„é¡¹ç›®è¾¾åˆ°äº†ä¸­å¤§å‹åº”ç”¨çš„è§„æ¨¡ï¼Œæ­¤æ—¶æ‚¨å¾ˆå¯èƒ½ä¼šè€ƒè™‘å¦‚ä½•æ›´å¥½åœ°åœ¨ç»„ä»¶å¤–éƒ¨ç®¡ç†çŠ¶æ€ï¼ŒVuex å°†ä¼šæˆä¸ºè‡ªç„¶è€Œç„¶çš„é€‰æ‹©ã€‚

ç¬¬äºŒæ­¥ ä½¿ç”¨ vuex
======

- å®‰è£…`npm install vuex --save`
- é…ç½® vuexï¼šåˆ›å»ºsrc/store/index.js
- ä¿®æ”¹ main.jsï¼š
- ä¿®æ”¹ App.vueï¼š
- å¯åŠ¨é¡¹ç›®`npm run dev`

é…ç½® vuexï¼š
- åˆ›å»ºsrc/store/index.js
- ä½¿ç”¨ Vue.useæ–¹æ³•ï¼Œ
- ä½¿ç”¨Vue.Storeæ–¹æ³•æ„é€ å®ä¾‹
Vue.Storeæ–¹æ³•çš„æ„é€ å‡½æ•°
	{state:xxx}
```
import Vue from 'vue';
import Vuex from 'vuex';

Vue.use(Vuex);

const store = new Vuex.Store({
  state: {
    name: 'å¼ ä¸‰',
    number: 0,
    list: [
      { id: 1, name: '111' },
      { id: 2, name: '222' },
      { id: 3, name: '333' },
    ],
  },
});

export default store;
```

- ä¿®æ”¹ main.jsï¼š å¼•å…¥å‰é¢å¯¼å‡ºçš„storeå¯¹è±¡ï¼Œæ·»åŠ åˆ° Vue çš„æ„é€ å‡½æ•°é‡Œ

```
import Vue from 'vue';
import App from './App';
import router from './router';
import store from './store'; // å¼•å…¥æˆ‘ä»¬å‰é¢å¯¼å‡ºçš„storeå¯¹è±¡

Vue.config.productionTip = false;

new Vue({
  el: '#app',
  router,
  store, // æŠŠstoreå¯¹è±¡æ·»åŠ åˆ°vueå®ä¾‹ä¸Š
  components: { App },
  template: '<App/>',
});

```

- æœ€åä¿®æ”¹ App.vueï¼šä½¿ç”¨this.$store.state.XXXå¯ä»¥ç›´æ¥è®¿é—®åˆ°ä»“åº“ä¸­çš„çŠ¶æ€

```
<template>
  <div></div>
</template>

<script>
export default {
  mounted() {
    // ä½¿ç”¨this.$store.state.XXXå¯ä»¥ç›´æ¥è®¿é—®åˆ°ä»“åº“ä¸­çš„çŠ¶æ€
    console.log(this.$store.state.name);
  },
};
</script>

```

- å¯åŠ¨é¡¹ç›®`npm run dev`ï¼Œå³å¯åœ¨æ§åˆ¶å°è¾“å‡ºåˆšæ‰æˆ‘ä»¬å®šä¹‰åœ¨ store ä¸­çš„ name çš„å€¼ã€‚

## ä½¿ç”¨å»ºè®®

*   ğŸ¤– å®˜æ–¹å»ºè®® 1ï¼š æ“ä½œ this.$store.state.XXX æœ€å¥½æ”¾åœ¨è®¡ç®—å±æ€§ä¸­ï¼Œå°±åƒè¿™æ ·ï¼š

```
export default {
  mounted() {
    console.log(this.getName);
  },
  computed: {
    getName() {
      return this.$store.state.name;
    },
  },
};
```

*   ğŸ¤– å®˜æ–¹å»ºè®® 2ï¼š æ˜¯ä¸æ˜¯æ¯æ¬¡éƒ½å†™ this.$store.state.XXX è®©ä½ æ„Ÿåˆ°åŒçƒ¦ï¼Œæœ‰è§£å†³æ–¹æ¡ˆï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š

```
<script>
import { mapState } from 'vuex'; // ä»vuexä¸­å¯¼å…¥mapState
export default {
  mounted() {
    console.log(this.name);
  },
  computed: {
    ...mapState(['name']), // ç»è¿‡è§£æ„åï¼Œè‡ªåŠ¨å°±æ·»åŠ åˆ°äº†è®¡ç®—å±æ€§ä¸­ï¼Œæ­¤æ—¶å°±å¯ä»¥ç›´æ¥åƒè®¿é—®è®¡ç®—å±æ€§ä¸€æ ·è®¿é—®å®ƒ
  },
};
</script>

```

ä½ ç”šè‡³å¯ä»¥åœ¨è§£æ„çš„æ—¶å€™ç»™å®ƒèµ‹åˆ«åï¼Œå–å¤–å·ï¼Œå°±åƒè¿™æ ·ï¼š

```
...mapState({ aliasName: 'name' }),  // èµ‹åˆ«åçš„è¯ï¼Œè¿™é‡Œæ¥æ”¶å¯¹è±¡ï¼Œè€Œä¸æ˜¯æ•°ç»„
```


ç¬¬ä¸‰æ­¥ï¼Œäº†è§£ä¿®é¥°å™¨ï¼šGetter
================
*   ğŸ¤¨ è®¾æƒ³ä¸€ä¸ªåœºæ™¯ï¼Œäº§å“ç»ç†ï¼šæ‰€æœ‰çš„ name å‰é¢éƒ½è¦åŠ ä¸Š â€œhelloâ€ï¼

æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ store ä¸­å¯¹ name è¿›è¡Œä¸€äº›æ“ä½œæˆ–è€…åŠ å·¥ï¼Œä»æºå¤´è§£å†³é—®é¢˜ï¼

## Getterä½¿ç”¨
- åœ¨ store å¯¹è±¡ä¸­å¢åŠ  getters å±æ€§
- åœ¨ç»„ä»¶ä¸­æŠŠ state æ›´æ”¹ä¸º getter

åœ¨ store å¯¹è±¡ä¸­å¢åŠ  getters å±æ€§
```
const store = new Vuex.Store({
  state: {
    name: 'å¼ ä¸‰',
    number: 0,
    list: [
      { id: 1, name: '111' },
      { id: 2, name: '222' },
      { id: 3, name: '333' },
    ],
  },
  // åœ¨storeå¯¹è±¡ä¸­å¢åŠ getterså±æ€§
  getters: {
    getMessage(state) {
      // è·å–ä¿®é¥°åçš„nameï¼Œç¬¬ä¸€ä¸ªå‚æ•°stateä¸ºå¿…è¦å‚æ•°ï¼Œå¿…é¡»å†™åœ¨å½¢å‚ä¸Š
      return `hello${state.name}`;
    },
  },
});

export default store;
```

åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ï¼š

```
export default {
  mounted() {
    // æ³¨æ„ä¸æ˜¯$store.stateäº†ï¼Œè€Œæ˜¯$store.getters
    console.log(this.$store.state.name);
    console.log(this.$store.getters.getMessage);
  },
};
```

## Getterå®˜æ–¹å»ºè®®
ğŸ¤– å®˜æ–¹å»ºè®®ï¼š æ˜¯ä¸æ˜¯æ¯æ¬¡éƒ½å†™ this.$store.getters.XXX è®©ä½ æ„Ÿåˆ°åŒçƒ¦ï¼Œå®˜æ–¹å»ºè®®æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ mapGetters å»è§£æ„åˆ°è®¡ç®—å±æ€§ä¸­ï¼Œå°±åƒä½¿ç”¨ mapState ä¸€æ ·ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ this è°ƒç”¨äº†ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š

```
<script>
import { mapState, mapGetters } from 'vuex';
export default {
  mounted() {
    console.log(this.name);
    console.log(this.getMessage);
  },
  computed: {
    ...mapState(['name']),
    ...mapGetters(['getMessage']),
  },
};
</script>

```

å’Œ mapState ä¸€æ ·ä½ ä¹Ÿå¯ä»¥å–åˆ«åï¼Œå–å¤–å·ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š

```
...mapGetters({ aliasName: 'getMessage' }),  // èµ‹åˆ«åçš„è¯ï¼Œè¿™é‡Œæ¥æ”¶å¯¹è±¡ï¼Œè€Œä¸æ˜¯æ•°ç»„
```

ç¬¬å››æ­¥ï¼Œäº†è§£å¦‚ä½•ä¿®æ”¹å€¼ï¼šMutation
====================


```
// é”™è¯¯ç¤ºèŒƒ
this.$store.state.XXX = XXX;
```

#### ç®€å•å®ç° mutations çš„æ–¹æ³•ï¼ˆæ²¡æœ‰ä¼ å‚ï¼‰
*   ä¿®æ”¹ store/index.jsï¼Œå¢åŠ mutationså±æ€§
*   å¯¹this.$store commit å¯¹åº”çš„ mutationcommit('setNumber')

ä¿®æ”¹ store/index.jsï¼Œå¢åŠ mutationså±æ€§
- mutation æ–¹æ³•çš„å‚æ•°ä¸º state
```
import Vue from 'vue';
import Vuex from 'vuex';

Vue.use(Vuex);

const store = new Vuex.Store({
  state: {
    name: 'å¼ ä¸‰',
    number: 0,
  },
  mutations: {
    // å¢åŠ nutationså±æ€§
    setNumber(state) {
      // å¢åŠ ä¸€ä¸ªmutationsçš„æ–¹æ³•ï¼Œæ–¹æ³•çš„ä½œç”¨æ˜¯è®©numä»0å˜æˆ5ï¼Œstateæ˜¯å¿…é¡»é»˜è®¤å‚æ•°
      state.number = 5;
    },
  },
});

export default store;

```

*   ä¿®æ”¹ App.vue

```
<script>
export default {
  mounted() {
    console.log(`æ—§å€¼ï¼š${this.$store.state.number}`);
    this.$store.commit('setNumber');
    console.log(`æ–°å€¼ï¼š${this.$store.state.number}`);
  },
};
</script>

```

### mutation ä¼ å‚
*   ä¿®æ”¹ store/index.js
	* mutation æ–¹æ³•çš„å‚æ•°ä¸º stateï¼Œnumber
```
const store = new Vuex.Store({
  state: {
    name: 'å¼ ä¸‰',
    number: 0,
  },
  mutations: {
    setNumber(state) {
      state.number = 5;
    },
    setNumberIsWhat(state, number) {
      // å¢åŠ ä¸€ä¸ªå¸¦å‚æ•°çš„mutationsæ–¹æ³•
      state.number = number;
    },
  },
});

export default store;

```

*   ä¿®æ”¹ App.vue

```
<script>
export default {
  mounted() {
    console.log(`æ—§å€¼ï¼š${this.$store.state.number}`);
    this.$store.commit('setNumberIsWhat', 666);
    console.log(`æ–°å€¼ï¼š${this.$store.state.number}`);
  },
};
</script>

```

### å®˜æ–¹å»ºè®® mutation ä¼ å‚
*   å®˜æ–¹å»ºè®®ä¼ é€’ä¸€ä¸ªå¯¹è±¡è¿›å»ï¼Œå¯¹è±¡ä¸€èˆ¬å‘½åä¸º payload
*   ä¿®æ”¹ store/index.js

```
mutations: {
    setNumber(state) {
      state.number = 5;
    },
    setNumberIsWhat(state, payload) {
      // å¢åŠ ä¸€ä¸ªå¸¦å‚æ•°çš„mutationsæ–¹æ³•ï¼Œå¹¶ä¸”å®˜æ–¹å»ºè®®payloadä¸ºä¸€ä¸ªå¯¹è±¡
      state.number = payload.number;
    },
  },

```

*   ä¿®æ”¹ App.vue

```
<script>
export default {
  mounted() {
    console.log(`æ—§å€¼ï¼š${this.$store.state.number}`);
    this.$store.commit('setNumberIsWhat', { number: 666 }); // è°ƒç”¨çš„æ—¶å€™ä¹Ÿéœ€è¦ä¼ é€’ä¸€ä¸ªå¯¹è±¡
    console.log(`æ–°å€¼ï¼š${this.$store.state.number}`);
  },
};
</script>

```

## mutation é‡è¦åŸåˆ™ï¼š
Mutationsé‡Œé¢çš„å‡½æ•°å¿…é¡»æ˜¯åŒæ­¥æ“ä½œï¼Œä¸èƒ½åŒ…å«å¼‚æ­¥æ“ä½œï¼

## mutation çš„ map
*   æˆ‘ä»¬åœ¨ç»„ä»¶ä¸­å¯ä»¥ä½¿ç”¨ mapMutations ä»¥ä»£æ›¿ this.$store.commit('XXX')

```
<script>
import { mapMutations } from 'vuex';
export default {
  mounted() {
    this.setNumberIsWhat({ number: 999 });
  },
  methods: {
    // æ³¨æ„ï¼ŒmapMutationsæ˜¯è§£æ„åˆ°methodsé‡Œé¢çš„ï¼Œè€Œä¸æ˜¯è®¡ç®—å±æ€§äº†
    ...mapMutations(['setNumberIsWhat']),
  },
};
</script>

```
*   å½“ç„¶ä½ ä¹Ÿå¯ä»¥ç»™å®ƒå«åˆ«åï¼Œå–å¤–å·ï¼Œå°±åƒè¿™æ ·ï¼š
```
methods: {
  ...mapMutations({ setNumberIsAlias: 'setNumberIsWhat' }), // èµ‹åˆ«åçš„è¯ï¼Œè¿™é‡Œæ¥æ”¶å¯¹è±¡ï¼Œè€Œä¸æ˜¯æ•°ç»„
},

```


ç¬¬äº”æ­¥ï¼Œå¼‚æ­¥æ“ä½œï¼šActions
==================

*   ä¿®æ”¹ store/index.js

```
const store = new Vuex.Store({
  state: {
    name: 'å¼ ä¸‰',
    number: 0,
  },
  mutations: {
    setNumberIsWhat(state, payload) {
      state.number = payload.number;
    },
  },
  actions: {
    // å¢åŠ actionså±æ€§
    setNum(content) {
      // å¢åŠ setNumæ–¹æ³•ï¼Œé»˜è®¤ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯contentï¼Œå…¶å€¼æ˜¯å¤åˆ¶çš„ä¸€ä»½store
      return new Promise(resolve => {
        // æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œ1ç§’åä¿®æ”¹numberä¸º888
        setTimeout(() => {
          content.commit('setNumberIsWhat', { number: 888 });
          resolve();
        }, 1000);
      });
    },
  },
});

```

*   ä¿®æ”¹ App.vue

```
async mounted() {
  console.log(`æ—§å€¼ï¼š${this.$store.state.number}`);
  await this.$store.dispatch('setNum');
  console.log(`æ–°å€¼ï¼š${this.$store.state.number}`);
},

```


action å°±æ˜¯å»æäº¤ mutation çš„ï¼Œä»€ä¹ˆå¼‚æ­¥æ“ä½œéƒ½åœ¨ action ä¸­æ¶ˆåŒ–äº†ï¼Œæœ€åå†å»æäº¤ mutation çš„ã€‚

### action çš„ map
*   ğŸ¤– å®˜æ–¹å»ºè®® 1ï¼šä½ å¦‚æœä¸æƒ³ä¸€ç›´ä½¿ç”¨ this.$store.dispatch('XXX') è¿™æ ·çš„å†™æ³•è°ƒç”¨ actionï¼Œä½ å¯ä»¥é‡‡ç”¨ mapActions çš„æ–¹å¼ï¼ŒæŠŠç›¸å…³çš„ actions è§£æ„åˆ° methods ä¸­ï¼Œç”¨ this ç›´æ¥è°ƒç”¨ï¼š

```
<script>
import { mapActions } from 'vuex';
export default {
  methods: {
    ...mapActions(['setNum']), // å°±åƒè¿™æ ·ï¼Œè§£æ„åˆ°methodsä¸­
  },
  async mounted() {
    await this.setNum({ number: 123 }); // ç›´æ¥è¿™æ ·è°ƒç”¨å³å¯
  },
};
</script>

```

å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥å–åˆ«åï¼Œå–å¤–å·ï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š

```
...mapActions({ setNumAlias: 'setNum' }),   // èµ‹åˆ«åçš„è¯ï¼Œè¿™é‡Œæ¥æ”¶å¯¹è±¡ï¼Œè€Œä¸æ˜¯æ•°ç»„

```

###  action çš„ç»“æ„
* ğŸ¤– å®˜æ–¹å»ºè®® 2ï¼šåœ¨ store/index.js ä¸­çš„ actions é‡Œé¢ï¼Œæ–¹æ³•çš„å½¢å‚å¯ä»¥ç›´æ¥å°† commit è§£æ„å‡ºæ¥ï¼Œè¿™æ ·å¯ä»¥æ–¹ä¾¿åç»­æ“ä½œï¼š

```
actions: {
  setNum({ commit }) {
    // ç›´æ¥å°†contentç»“æ„æ‰ï¼Œè§£æ„å‡ºcommitï¼Œä¸‹é¢å°±å¯ä»¥ç›´æ¥è°ƒç”¨äº†
    return new Promise(resolve => {
      setTimeout(() => {
        commit('XXXX'); // ç›´æ¥è°ƒç”¨
        resolve();
      }, 1000);
    });
  },
},

```

*   ä¸è¦å°† action å’Œ mutation æ··ä¸ºä¸€è°ˆï¼Œaction å…¶å®å°±æ˜¯ mutation çš„ä¸Šä¸€çº§ï¼Œåœ¨ action è¿™é‡Œå¤„ç†å®Œå¼‚æ­¥çš„ä¸€äº›æ“ä½œåï¼Œåé¢çš„ä¿®æ”¹ state å°±äº¤ç»™ mutation å»åšäº†ã€‚

ç¬¬å…­æ­¥ï¼ŒæŒ‰å±æ€§è¿›è¡Œæ‹†åˆ†
===========

å¦‚æœä½ æ˜¯ä¸€ä¸ªç¨å¾®æœ‰äº›è§„æ ¼çš„é¡¹ç›®ï¼Œé‚£ä¹ˆä½ å°†ä¼šå¾—åˆ°ä¸€ä¸ªæˆç™¾ä¸Šåƒè¡Œçš„ index.jsï¼Œç„¶åæŸ¥æ‰¾ä¸€äº›ä¸œè¥¿å°±ä¼šéå¸¸è´¹åŠ²ï¼Œ
æ—¢ç„¶é—®é¢˜å‡ºæ¥äº†ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹æ€ä¹ˆæ‹†åˆ†ä¸€ä¸‹ã€‚
æˆ‘ä»¬çœ‹åˆ°ï¼Œä¸€ä¸ª store/index.js é‡Œé¢å¤§è‡´åŒ…å« state/getters/mutations/actions è¿™å››ä¸ªå±æ€§ï¼Œ
æˆ‘ä»¬å¯ä»¥å½»åº•ç‚¹ï¼Œindex.js é‡Œé¢å°±ä¿æŒè¿™ä¸ªæ¶å­ï¼ŒæŠŠé‡Œé¢çš„å†…å®¹å››æ•£åˆ°å…¶ä»–æ–‡ä»¶ä¸­ã€‚

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dc39e92fcf7242d78da6329d64ce1d44~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp?)

äºæ˜¯æˆ‘ä»¬å¯ä»¥æ–°å»ºå››ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯`state.js` `getters.js` `mutations.js` `actions.js`ï¼š

![](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d9443814df5e48579e1bac65e48a22f4~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.awebp?)

*   1.  æ‹†å‡ºæ¥`state`æ”¾åˆ°`state.js`ä¸­ï¼š

```
// state.js

export const state = {
  name: 'å¼ ä¸‰',
  number: 0,
  list: [
    { id: 1, name: '111' },
    { id: 2, name: '222' },
    { id: 3, name: '333' },
  ],
};

```

*   2.  æ‹†å‡ºæ¥`getters`æ”¾åˆ°`getters.js`ä¸­ï¼š

```
// getters.js

export const getters = {
  getMessage(state) {
    return `hello${state.name}`;
  },
};

```

*   3.  æ‹†å‡ºæ¥`mutations`æ”¾åˆ°`mutations.js`ä¸­ï¼š

```
// mutations.js

export const mutations = {
  setNumber(state) {
    state.number = 5;
  },
};

```

*   4.  æ‹†å‡ºæ¥`actions`æ”¾åˆ°`actions.js`ä¸­ï¼š

```
// actions.js

export const actions = {
  setNum(content) {
    return new Promise(resolve => {
      setTimeout(() => {
        content.commit('setNumberIsWhat', { number: 888 });
        resolve();
      }, 1000);
    });
  },
};

```

5.  ç»„è£…åˆ°ä¸»æ–‡ä»¶é‡Œé¢ï¼š

```
import Vue from 'vue';
import Vuex from 'vuex';
import { state } from './state'; // å¼•å…¥ state
import { getters } from './getters'; // å¼•å…¥ getters
import { mutations } from './mutations'; // å¼•å…¥ mutations
import { actions } from './actions'; // å¼•å…¥ actions

Vue.use(Vuex);

const store = new Vuex.Store({
  state: state,
  getters: getters,
  mutations: mutations,
  actions: actions,
});

// å¯ä»¥ç®€å†™æˆä¸‹é¢è¿™æ ·ï¼š

// const store = new Vuex.Store({ state, getters, mutations, actions });

export default store;

```


ç¬¬ä¸ƒæ­¥ï¼ŒæŒ‰åŠŸèƒ½è¿›è¡Œæ‹†åˆ† - Module
====================
â€˜æŒ‰**åŠŸèƒ½**â€™ï¼ŒæŒ‰åŠŸèƒ½æ‹†åˆ†çš„è¯ï¼Œå°±æ˜¯æˆ‘ä»¬çš„æ ‡é¢˜ **Module(æ¨¡å—)** ã€‚

1. æ–°å¢ä»“åº“
2. modules å±æ€§å¼•å…¥
3. this.$store.state.store2.nameè®¿é—®

*   1.  å¢åŠ ä¸€ä¸ªæ–°çš„ä»“åº“ store2ï¼Œä¸»è¦ä»£ç å¦‚ä¸‹ï¼š

```
const store2 = {
  state: {
    name: 'æˆ‘æ˜¯store2',
  },
  mutations: {},
  getters: {},
  actions: {},
};

export default store2;
```

*   2.  ç„¶ååœ¨ store ä¸­çš„ modules å±æ€§å¼•å…¥æˆ‘ä»¬æ–°åˆ›å»ºçš„ store2 æ¨¡å—ï¼š

```
import Vue from 'vue';
import Vuex from 'vuex';
import { state } from './state';
import { getters } from './getters';
import { mutations } from './mutations';
import { actions } from './actions';
import store2 from './store2'; // å¼•å…¥store2æ¨¡å—

Vue.use(Vuex);

const store = new Vuex.Store({
  modules: { store2 }, // æŠŠstore2æ¨¡å—æŒ‚è½½åˆ°storeé‡Œé¢
  state: state,
  getters: getters,
  mutations: mutations,
  actions: actions,
});

export default store;

```

*   3.  è®¿é—® state é€šè¿‡this.$store.state.store2.name

```
<template>
  <div></div>
</template>

<script>
export default {
  mounted() {
    console.log(this.$store.state.store2.name); // è®¿é—®store2é‡Œé¢çš„nameå±æ€§
  },
};
</script>

```

æˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„ä»£ç å¯ä»¥äº†è§£åˆ°åœ¨ä¸åŒçš„å±æ€§é‡Œæ˜¯æ€ä¹ˆè®¿é—® **æ¨¡å—å†…çš„çŠ¶æ€** æˆ–è€… **æ ¹çŠ¶æ€**ï¼š

```
mutations: {
  changeName(state, payload) {
    // state å±€éƒ¨çŠ¶æ€
    console.log(state);
    console.log(payload.where);
  },
},
getters: {
  testGetters(state, getters, rootState) {
    // state å±€éƒ¨çŠ¶æ€
    console.log(state);
    // å±€éƒ¨ getters,
    console.log(getters);
    // rootState æ ¹èŠ‚ç‚¹çŠ¶æ€
    console.log(rootState);
  },
},
actions: {
  increment({ state, commit, rootState }) {
    // state å±€éƒ¨çŠ¶æ€
    console.log(state);
    // rootState æ ¹èŠ‚ç‚¹çŠ¶æ€
    console.log(rootState);
  },
},

```


### module çš„å…¶ä»–å†…å®¹

å…¶å®ä»¥ä¸Šå¹¶ä¸æ˜¯ module çš„å…¨éƒ¨ï¼Œè¿˜æœ‰ä¸€äº›æ¯”å¦‚`å‘½åç©ºé—´`ã€`æ¨¡å—æ³¨å†Œå…¨å±€ action`ã€`å¸¦å‘½åç©ºé—´çš„ç»‘å®šå‡½æ•°`ã€`æ¨¡å—åŠ¨æ€æ³¨å†Œ`ã€`æ¨¡å—é‡ç”¨`ç­‰æ–¹æ³•è¿™é‡Œå°±æ²¡ä»‹ç»ï¼Œå¦‚æœä½ åœ¨é¡¹ç›®ä¸­ä½¿ç”¨åˆ°äº†ï¼Œå†è¿›è¡ŒæŸ¥é˜…å³å¯ï¼Œæœ‰æ—¶å€™ä¸éœ€è¦å®Œå…¨ç†è§£ï¼ŒçŸ¥é“æœ‰è¿™ä¸ªä¸œè¥¿å°±è¡Œï¼ŒçŸ¥é“å‡ºäº†é—®é¢˜çš„æ—¶å€™è¯¥å»å“ªæŸ¥èµ„æ–™å°±å¤Ÿå•¦ã€‚ğŸ˜Š
